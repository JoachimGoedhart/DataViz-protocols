<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Reading and reshaping data | DataViz protocols</title>
  <meta name="description" content="This is an introduction to data visualization protocols for wet lab scientists" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Reading and reshaping data | DataViz protocols" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an introduction to data visualization protocols for wet lab scientists" />
  <meta name="github-repo" content="JoachimGoedhart/DataViz-protocols" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Reading and reshaping data | DataViz protocols" />
  
  <meta name="twitter:description" content="This is an introduction to data visualization protocols for wet lab scientists" />
  

<meta name="author" content="Joachim Goedhart" />


<meta name="date" content="2022-08-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-started.html"/>
<link rel="next" href="plotting-the-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZDBZZ5FR0E"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZDBZZ5FR0E');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DataViz Protocols</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-toast"><i class="fa fa-check"></i>A toast</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#running-r"><i class="fa fa-check"></i><b>1.1</b> Running R</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#using-the-command-line"><i class="fa fa-check"></i><b>1.2</b> Using the command line</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#help"><i class="fa fa-check"></i><b>1.3</b> ?Help</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#installing-packages"><i class="fa fa-check"></i><b>1.4</b> Installing packages</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#multiline-code"><i class="fa fa-check"></i><b>1.5</b> Multiline code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="read-and-reshape.html"><a href="read-and-reshape.html"><i class="fa fa-check"></i><b>2</b> Reading and reshaping data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="read-and-reshape.html"><a href="read-and-reshape.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="read-and-reshape.html"><a href="read-and-reshape.html#types-of-data"><i class="fa fa-check"></i><b>2.2</b> Types of data</a></li>
<li class="chapter" data-level="2.3" data-path="read-and-reshape.html"><a href="read-and-reshape.html#reading-data"><i class="fa fa-check"></i><b>2.3</b> Reading data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="read-and-reshape.html"><a href="read-and-reshape.html#loading-data-from-a-text-or-csv-file"><i class="fa fa-check"></i><b>2.3.1</b> Loading data from a text or csv file</a></li>
<li class="chapter" data-level="2.3.2" data-path="read-and-reshape.html"><a href="read-and-reshape.html#loading-data-from-a-url"><i class="fa fa-check"></i><b>2.3.2</b> Loading data from a URL</a></li>
<li class="chapter" data-level="2.3.3" data-path="read-and-reshape.html"><a href="read-and-reshape.html#retrieving-data-from-excel"><i class="fa fa-check"></i><b>2.3.3</b> Retrieving data from Excel</a></li>
<li class="chapter" data-level="2.3.4" data-path="read-and-reshape.html"><a href="read-and-reshape.html#retrieving-data-from-multiple-files"><i class="fa fa-check"></i><b>2.3.4</b> Retrieving data from multiple files</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="read-and-reshape.html"><a href="read-and-reshape.html#tidy-data"><i class="fa fa-check"></i><b>2.4</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="read-and-reshape.html"><a href="read-and-reshape.html#quantitative-data-discrete-conditions"><i class="fa fa-check"></i><b>2.4.1</b> Quantitative data, discrete conditions</a></li>
<li class="chapter" data-level="2.4.2" data-path="read-and-reshape.html"><a href="read-and-reshape.html#multiple-discrete-conditions"><i class="fa fa-check"></i><b>2.4.2</b> Multiple discrete conditions</a></li>
<li class="chapter" data-level="2.4.3" data-path="read-and-reshape.html"><a href="read-and-reshape.html#double-quantitative-data"><i class="fa fa-check"></i><b>2.4.3</b> Double quantitative data</a></li>
<li class="chapter" data-level="2.4.4" data-path="read-and-reshape.html"><a href="read-and-reshape.html#data-from-multiple-files"><i class="fa fa-check"></i><b>2.4.4</b> Data from multiple files</a></li>
<li class="chapter" data-level="2.4.5" data-path="read-and-reshape.html"><a href="read-and-reshape.html#data-in-96-wells-format-data-in-96-wells-format"><i class="fa fa-check"></i><b>2.4.5</b> Data in 96-wells format {data-in-96-wells-format}</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting-the-data.html"><a href="plotting-the-data.html"><i class="fa fa-check"></i><b>3</b> Plotting the Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#data-over-time-continuous-vs.-continuous"><i class="fa fa-check"></i><b>3.1</b> Data over time (continuous vs. continuous)</a></li>
<li class="chapter" data-level="3.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#discrete-conditions"><i class="fa fa-check"></i><b>3.2</b> Discrete conditions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#x-axis-data-qualitative-versus-quantitative-data"><i class="fa fa-check"></i><b>3.2.1</b> X-axis data: qualitative versus quantitative data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="plotting-the-data.html"><a href="plotting-the-data.html#statistics"><i class="fa fa-check"></i><b>3.3</b> Statistics</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#introduction-1"><i class="fa fa-check"></i><b>3.3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.3.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#data-summaries-directly-added-as-a-plot-layer"><i class="fa fa-check"></i><b>3.3.2</b> Data summaries directly added as a plot layer</a></li>
<li class="chapter" data-level="3.3.3" data-path="plotting-the-data.html"><a href="plotting-the-data.html#data-summaries-from-a-dataframe"><i class="fa fa-check"></i><b>3.3.3</b> Data summaries from a dataframe</a></li>
<li class="chapter" data-level="3.3.4" data-path="plotting-the-data.html"><a href="plotting-the-data.html#data-summaries-for-continuous-x-axis-data"><i class="fa fa-check"></i><b>3.3.4</b> Data summaries for continuous x-axis data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="plotting-the-data.html"><a href="plotting-the-data.html#plot-a-lot---discrete-data"><i class="fa fa-check"></i><b>3.4</b> Plot-a-lot - discrete data</a></li>
<li class="chapter" data-level="3.5" data-path="plotting-the-data.html"><a href="plotting-the-data.html#optimizing-the-data-visualization"><i class="fa fa-check"></i><b>3.5</b> Optimizing the data visualization</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#rotation"><i class="fa fa-check"></i><b>3.5.1</b> Rotation</a></li>
<li class="chapter" data-level="3.5.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#ordering-conditions"><i class="fa fa-check"></i><b>3.5.2</b> Ordering conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="plotting-the-data.html"><a href="plotting-the-data.html#adjusting-the-layout"><i class="fa fa-check"></i><b>3.6</b> Adjusting the layout</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#themes"><i class="fa fa-check"></i><b>3.6.1</b> Themes</a></li>
<li class="chapter" data-level="3.6.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#legend"><i class="fa fa-check"></i><b>3.6.2</b> Legend</a></li>
<li class="chapter" data-level="3.6.3" data-path="plotting-the-data.html"><a href="plotting-the-data.html#grids"><i class="fa fa-check"></i><b>3.6.3</b> Grids</a></li>
<li class="chapter" data-level="3.6.4" data-path="plotting-the-data.html"><a href="plotting-the-data.html#labelstitles"><i class="fa fa-check"></i><b>3.6.4</b> Labels/Titles</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="plotting-the-data.html"><a href="plotting-the-data.html#plot-a-lot---continuous-data"><i class="fa fa-check"></i><b>3.7</b> Plot-a-lot - continuous data</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#small-multiples"><i class="fa fa-check"></i><b>3.7.1</b> Small multiples</a></li>
<li class="chapter" data-level="3.7.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#heatmaps"><i class="fa fa-check"></i><b>3.7.2</b> Heatmaps</a></li>
<li class="chapter" data-level="3.7.3" data-path="plotting-the-data.html"><a href="plotting-the-data.html#custom-objects"><i class="fa fa-check"></i><b>3.7.3</b> Custom objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="complete-protocols.html"><a href="complete-protocols.html"><i class="fa fa-check"></i><b>4</b> Complete protocols</a>
<ul>
<li class="chapter" data-level="4.1" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-1"><i class="fa fa-check"></i><b>4.1</b> Protocol 1 - Spectra of fluorescent proteins</a></li>
<li class="chapter" data-level="4.2" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-2"><i class="fa fa-check"></i><b>4.2</b> Protocol 2 - A superplot of calcium concentrations</a></li>
<li class="chapter" data-level="4.3" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-3"><i class="fa fa-check"></i><b>4.3</b> Protocol 3 - small multiples of time courses</a></li>
<li class="chapter" data-level="4.4" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-4"><i class="fa fa-check"></i><b>4.4</b> Protocol 4 - Plotting data from a 96-wells experiment</a></li>
<li class="chapter" data-level="4.5" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-5"><i class="fa fa-check"></i><b>4.5</b> Protocol 5 - A map of amino acids</a></li>
<li class="chapter" data-level="4.6" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-6"><i class="fa fa-check"></i><b>4.6</b> Protocol 6 - Heatmap style visualization of timelapse data</a></li>
<li class="chapter" data-level="4.7" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-7"><i class="fa fa-check"></i><b>4.7</b> Protocol 7 - Ridgeline plot</a></li>
<li class="chapter" data-level="4.8" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-8"><i class="fa fa-check"></i><b>4.8</b> Protocol 8 - Plotting data in a 96-wells layout</a></li>
<li class="chapter" data-level="4.9" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-9"><i class="fa fa-check"></i><b>4.9</b> Protocol 9 - A dose response curve with fit</a></li>
<li class="chapter" data-level="4.10" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-10"><i class="fa fa-check"></i><b>4.10</b> Protocol 10 - Plotting data that was harvestd with a Google form</a></li>
<li class="chapter" data-level="4.11" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-11"><i class="fa fa-check"></i><b>4.11</b> Protocol 11 - Plotting time data from a Google form</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="questions-and-answers.html"><a href="questions-and-answers.html"><i class="fa fa-check"></i><b>5</b> Questions and Answers</a>
<ul>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-is-the-difference-between-a-data.frame-and-a-tibble"><i class="fa fa-check"></i>What is the difference between a data.frame and a tibble?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#whats-up-with-spaces-in-variable-names-and-in-files-names"><i class="fa fa-check"></i>What’s up with spaces in variable names and in files names?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-are-the-rules-for-naming-dataframes-or-variables"><i class="fa fa-check"></i>What are the rules for naming dataframes or variables?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-is-the-difference-between---and-for-assigning-variables"><i class="fa fa-check"></i>What is the difference between <code>&lt;-</code> and <code>=</code> for assigning variables?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-does-na-mean-in-a-dataframe"><i class="fa fa-check"></i>What does ‘NA’ mean in a dataframe?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-is-the-beste-way-to-type-a-operator"><i class="fa fa-check"></i>What is the beste way to type a ‘%&gt;%’ operator?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#where-do-i-find-the-example-data"><i class="fa fa-check"></i>Where do I find the example data?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#is-there-a-way-to-re-use-or-adjust-the-protocols"><i class="fa fa-check"></i>Is there a way to re-use or adjust the protocols?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#which-packages-are-included-in-the-tidyverse-package"><i class="fa fa-check"></i>Which packages are included in the <code>{tidyverse}</code> package?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-is-the-difference-between-require-and-library-for-loading-a-package"><i class="fa fa-check"></i>What is the difference between <code>require()</code> and <code>library()</code> for loading a package?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#is-it-possible-to-have-interactive-file-selection"><i class="fa fa-check"></i>Is it possible to have interactive file selection?</a></li>
<li><a href="questions-and-answers.html#section"></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DataViz protocols</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="read-and-reshape" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Reading and reshaping data<a href="read-and-reshape.html#read-and-reshape" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Introduction<a href="read-and-reshape.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Experimental data can be recorded and stored in different ways. Anything that is not digital (e.g. notes in an physical labbook) has to be converted, before it can be used in a computer. Nowadays, most information is already in a digital format and stored in a file. This can be a text file, an excel file, or a file generated by a piece of equipment.
In R, the main structure for storing and processing data is a ‘dataframe’ (a modernized version of the dataframe is a ‘tibble’, which is available when the tidyverse package is used). The dataset <code>mtcars</code> that comes with R is a dataframe. We can check the type of a structure or variable by using the function <code>class()</code>. This is a very helpful function to learn about the class of an object:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="read-and-reshape.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mtcars)</span></code></pre></div>
<pre><code>[1] &quot;data.frame&quot;</code></pre>
<p>The dataframe itself can be printed by just typing its name. To look only at the first rows we can use the function <code>head()</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="read-and-reshape.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span></code></pre></div>
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>When we read experimental data from a file, this implies that we transfer the information to a dataframe in R. A dataframe can hold several types of data. Let’s first look at what different types of data you may encounter.</p>
</div>
<div id="types-of-data" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Types of data<a href="read-and-reshape.html#types-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All the information that is recorded during an experiment can be considered as data. Details of the experimental approach or setup are called metadata, and the data that is measured is the raw data. Data visualization primarily deals with the raw, measured data. Yet, adding data on the experimental design or other types of metadata can be important for the interpretation of the data.
The raw data mostly consist of numbers, but these are often accompanied by labels for experimental conditions or to identify objects. All this information is data, but they are clearly of different types. Let’s have a look at the most common types of data.</p>
<p>Measurements usually result in quantitative data consisting of numbers. For instance when an optical density is measured with a spectrophotometer or when temperature is determined with a thermometer. This kind of data is called <em>quantitative and continuous</em> data, since it can have any number ranging from minus to plus infinity. Another type of quantitive data is <em>quantitative and discrete</em> data and it consists only of natural numbers. An example is the number of colonies on an agar plate or the number of replicates.
There is also data that cannot be expressed in numbers and we call that <em>qualitative</em> data. For instance different experimental categories, e.g. ‘control’ and ‘treated’. This is also known as nominal data (ordinal data is not treated as it is not used in this book).
It is important to make the distinction between different types of data and tell R how to treat the data. In some cases a number stored in a file can be a category and it is important to treat the number as a category and not as quantitative data. We will see that R stores information about the type of data in the example below.</p>
<p>The variable x to which we assigned a value of 1 is:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="read-and-reshape.html#cb21-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb21-2"><a href="read-and-reshape.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code></pre></div>
<pre><code>[1] &quot;numeric&quot;</code></pre>
<p>We can convert this to a ‘factor’, which means that it is no longer a number but qualitative data:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="read-and-reshape.html#cb23-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(x)</span>
<span id="cb23-2"><a href="read-and-reshape.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code></pre></div>
<pre><code>[1] &quot;factor&quot;</code></pre>
<p>And therefore, this will give an error:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="read-and-reshape.html#cb25-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> <span class="dv">1</span></span></code></pre></div>
<pre><code>[1] NA</code></pre>
<p>When we convert it back to a number, it works:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="read-and-reshape.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(x) <span class="sc">+</span> <span class="dv">1</span></span></code></pre></div>
<pre><code>[1] 2</code></pre>
<p>This simple example illustrates the difference between quantitative and qualitative data and it shows that we can change the data type in R.</p>
</div>
<div id="reading-data" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Reading data<a href="read-and-reshape.html#reading-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Reading, or loading data is the transfer of information from a file to the memory of R where it is stored as a dataframe. Rstudio supports ‘point-and-click’ loading of data from its menu (File &gt; Import Dataset &gt; …). This is a convenient way of loading data. Since the aim is to perform all steps in a script, including data loading, I’ll explain how functions are used to load data from the console.</p>
<div id="loading-data-from-a-text-or-csv-file" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Loading data from a text or csv file<a href="read-and-reshape.html#loading-data-from-a-text-or-csv-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we can read the file, we need to make sure that we can locate the file. In RStudio you can select the directory (folder) from the menu: Session &gt; Set Working Directory &gt; Choose Directory…</p>
<p>If you are running an R script and the data is in the same directory as the script, you can go to the menu of Rstudio and select: Session &gt; Set Working Directory &gt; To Source File Location</p>
<p>When the directory is properly set, you can read the file. A common file format is the ‘comma separated values’ or CSV format. Here we load a CSV file that was obtained from <a href="www.fpbase.org">fpbase.org</a> and contains the excitation and emission data of Green Fluorescent Protein. This file and all other example data are available at github: <a href="https://github.com/JoachimGoedhart/DataViz-protocols">https://github.com/JoachimGoedhart/DataViz-protocols</a>
The function <code>read_csv()</code> is used to read the file and the data is assigned to a dataframe called ‘df’:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="read-and-reshape.html#cb29-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;FPbase_Spectra.csv&#39;</span>)</span></code></pre></div>
<p>To check whether the loading was successful, we can look at the first lines of the dataframe with the function <code>head()</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="read-and-reshape.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>  Wavelength mEGFP.EM mEGFP.EX
1        300       NA   0.0962
2        301       NA   0.0872
3        302       NA   0.0801
4        303       NA   0.0739
5        304       NA   0.0675
6        305       NA   0.0612</code></pre>
<p>This data has several columns, each containing quantitative data. Empty cells that do not have any data will be displayed as ‘NA’. Note that this is different from ‘0’.</p>
<p>The ‘delimiter’ of a file is a character that separates the different fields of data. In a CSV file, as the name implies, this is a comma. However, other characters such as semicolons or tabs are often used as delimiters in text files. The function ‘read.delim()’ can be used to load a text file with a delimiter that can be specified, and therefore this function is more flexible for loading of data. For the CSV file, it would be used like this:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="read-and-reshape.html#cb32-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&#39;FPbase_Spectra.csv&#39;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
</div>
<div id="loading-data-from-a-url" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Loading data from a URL<a href="read-and-reshape.html#loading-data-from-a-url" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When the CSV file is available online, e.g. in a data repository or on Github, it can be loaded by providng the URL:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="read-and-reshape.html#cb33-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;https://zenodo.org/record/2545922/files/FRET-efficiency_mTq2.csv&#39;</span>)</span>
<span id="cb33-2"><a href="read-and-reshape.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>      EGFP   mNeonG   Clover mKOkappa mOrange2 mScarlet.I   mRuby2 TagRFP.T
1 46.25865 61.27913 52.85122 47.28077 25.70513   36.03078 51.68192 12.39361
2 46.48604 60.97392 54.05560 48.42123 26.43752   34.93961 33.75286 12.59682
3 46.66348 61.27877 48.93475 44.93190 24.47023   25.38569 41.93491 14.03628
4 46.30399 60.80149 48.95284 45.47728 21.72633   28.27172 33.68123 12.59829
5 45.67780 59.89690 52.97067 44.03166 21.52321   34.00304 35.81131 20.86654
6 45.35124 62.76465 52.57957 47.08019 23.44953   34.64273 48.87000 23.78392
   mCherry
1 31.31533
2 30.85531
3 30.66732
4 34.28993
5 35.64215
6 28.99762</code></pre>
</div>
<div id="retrieving-data-from-excel" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Retrieving data from Excel<a href="read-and-reshape.html#retrieving-data-from-excel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have an excel file with multiple tabs and we would like to access the data for mNeonGreen. To import the correct data into a dataframe use:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="read-and-reshape.html#cb35-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&#39;FPbase_Spectra.xlsx&#39;</span>, <span class="at">sheet =</span> <span class="st">&#39;mNeonGreen&#39;</span>)</span>
<span id="cb35-2"><a href="read-and-reshape.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
  Wavelength `mNeonGreen EM` `mNeonGreen EX`
       &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;
1        300              NA              NA
2        301              NA              NA
3        302              NA              NA
4        303              NA              NA
5        304              NA              NA
6        305              NA              NA</code></pre>
<p>Again, ‘NA’ indicates that no data is available. Since the <code>read_excel()</code> is a funtion from the ‘tidyverse’ the data is stored in a tibble. This can be converted to an ordinary dataframe:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="read-and-reshape.html#cb37-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb37-2"><a href="read-and-reshape.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df)</span></code></pre></div>
<pre><code>[1] &quot;data.frame&quot;</code></pre>
<p>Now that we have the data loaded, we can generate a plot. For simplicity I use the <code>qplot()</code> function. The more flexible <code>ggplot()</code> function will be introduced later. We need to supply the name of the dataframe, the column for the x-axis data and the column that is used for the y-axis. Note that two of the column names have a space and to properly indicate the name of the column we need to enclose the name with backtics (`).</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="read-and-reshape.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">data=</span>df,<span class="at">x=</span>Wavelength, <span class="at">y=</span><span class="st">`</span><span class="at">mNeonGreen EX</span><span class="st">`</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>A plot with lines instead of dots can be made by supplying this alternative ‘geometry’:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="read-and-reshape.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">data=</span>df,<span class="at">x=</span>Wavelength, <span class="at">y=</span><span class="st">`</span><span class="at">mNeonGreen EX</span><span class="st">`</span>, <span class="at">geom=</span><span class="st">&#39;line&#39;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>The plots show the excitation spectrum of mNeonGreen, and it can be inferred that the protein is maximally excited near 500 nm.
In its current shape, the dataframe is not suitable for simultaneously plotting the excitation and emission spectrum. To do that, we need to reshape the data and this will be the topic of the <a href="read-and-reshape.html#tidy-data">Reshaping data</a> section.</p>
</div>
<div id="retrieving-data-from-multiple-files" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Retrieving data from multiple files<a href="read-and-reshape.html#retrieving-data-from-multiple-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When the data is spread over multiple files, it is useful to read these files and combine them into one dataframe. In this example we have the data from three different conditions, each is an individual CSV file. First we create a list with the files based on a pattern. In this case the relevant files contain the string <code>S1P.csv</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="read-and-reshape.html#cb41-1" aria-hidden="true" tabindex="-1"></a>filelist <span class="ot">=</span> <span class="fu">list.files</span>(<span class="at">pattern=</span><span class="st">&quot;*S1P.csv&quot;</span>)</span>
<span id="cb41-2"><a href="read-and-reshape.html#cb41-2" aria-hidden="true" tabindex="-1"></a>filelist</span></code></pre></div>
<pre><code>[1] &quot;Cdc42_S1P.csv&quot; &quot;Rac_S1P.csv&quot;   &quot;Rho_S1P.csv&quot;  </code></pre>
<p>Then we use the function <code>map()</code> to perform the function <code>read.csv()</code> for each of the files and we store the result in a new dataframe ‘df_input_list’.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="read-and-reshape.html#cb43-1" aria-hidden="true" tabindex="-1"></a>df_input_list <span class="ot">&lt;-</span> <span class="fu">map</span>(filelist, read.csv)</span></code></pre></div>
<p>The result is a ‘nested’ dataframe, which is a dataframe with dataframes. Instead of having three separate dataframes, we want a single dataframe but it should have a label that reflects the condition. The labels are based on the filenames. We can use <code>str_replace()</code> to remove the extension of the filenames:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="read-and-reshape.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_input_list) <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(filelist, <span class="at">pattern =</span> <span class="st">&quot;.csv&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>After this, we merge the dataframes and create a column ‘id’ that has the label with the filename:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="read-and-reshape.html#cb45-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_input_list, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb45-2"><a href="read-and-reshape.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>         id      Time    Cell.1    Cell.2    Cell.3    Cell.4    Cell.5
1 Cdc42_S1P 0.0000000 1.0035170 1.0015490 0.9810209 0.9869040 1.0041990
2 Cdc42_S1P 0.1666667 0.9991689 0.9961631 0.9801265 0.9891608 0.9989283
3 Cdc42_S1P 0.3333333 1.0013450 1.0046440 1.0106020 1.0124910 0.9953477
4 Cdc42_S1P 0.5000000 1.0015790 1.0043180 1.0106890 1.0066810 1.0027020
5 Cdc42_S1P 0.6666667 0.9943522 0.9933341 1.0168220 1.0045540 0.9988462
6 Cdc42_S1P 0.8333333 1.0046240 1.0071780 1.0140210 1.0042580 0.9920673
     Cell.6    Cell.7    Cell.8    Cell.9  Cell.10   Cell.11   Cell.12
1 1.0049370 1.0042000 1.0014210 1.0001080 1.000748 1.0015060 1.0057850
2 0.9892894 0.9903881 0.9975485 0.9937496 0.995352 0.9962637 0.9972004
3 1.0104820 1.0140110 1.0016740 1.0003500 1.003132 1.0015520 0.9942397
4 1.0031760 1.0016000 1.0000720 1.0035080 1.000595 1.0017760 1.0035220
5 0.9921757 0.9898673 0.9993021 1.0023010 1.000192 0.9989264 0.9993660
6 1.0081460 1.0075700 0.9985681 1.0013800 1.001741 0.9989417 1.0028090
    Cell.13   Cell.14   Cell.15   Cell.16   Cell.17   Cell.18   Cell.19 Cell.20
1 1.0111880 1.0147230 1.0089390 1.0032410 1.0068720 1.0019290 1.0008660      NA
2 0.9894263 1.0044960 1.0026040 0.9978889 0.9970717 0.9993551 0.9980562      NA
3 0.9921575 1.0073610 1.0029890 1.0009640 0.9984493 0.9968905 0.9966830      NA
4 1.0102150 0.9910634 0.9943020 0.9942904 0.9932356 1.0059050 1.0043110      NA
5 0.9974161 0.9829283 0.9912844 1.0037130 1.0045560 0.9959676 1.0000940      NA
6 1.0070350 0.9790479 0.9861535 1.0059600 1.0065300 1.0070570 1.0049470      NA
  Cell.21 Cell.22 Cell.23 Cell.24 Cell.25 Cell.26 Cell.27 Cell.28 Cell.29
1      NA      NA      NA      NA      NA      NA      NA      NA      NA
2      NA      NA      NA      NA      NA      NA      NA      NA      NA
3      NA      NA      NA      NA      NA      NA      NA      NA      NA
4      NA      NA      NA      NA      NA      NA      NA      NA      NA
5      NA      NA      NA      NA      NA      NA      NA      NA      NA
6      NA      NA      NA      NA      NA      NA      NA      NA      NA
  Cell.30 Cell.31 Cell.32
1      NA      NA      NA
2      NA      NA      NA
3      NA      NA      NA
4      NA      NA      NA
5      NA      NA      NA
6      NA      NA      NA</code></pre>
<p>This dataframe contains all the relevant information, but it is not tidy yet. We’ll discuss how to convert this dataframe into a tidy format. We can save this dataframe for later:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="read-and-reshape.html#cb47-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="st">&#39;df_S1P_combined.csv&#39;</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="tidy-data" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Reshaping data<a href="read-and-reshape.html#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data is often recorded in tables or spreadsheets. Columns are typically used for different conditions (indicated in a header) and each data cell contains a measured value. Although this format makes perfect sense for humans, it is less suitable for analysis and visualization in R. Instead of the tabular, or wide, format, the functions from the tidyverse package work with data in a ‘tidy’ format. The benefit of tidy data is that it is a consistent way to structure datasets, facilitating data manipulation and visualization <a href="https://doi.org/10.18637/jss.v059.i10">Wickham, 2014</a>. In other words, this format simplifies downstream processing and visualization.
In this section, I will show how data can be converted from spreadsheet format to a long, tidy format. This step is needed to prepare the data for visualization with <code>ggplot()</code> which is also part of the tidyverse package. I will use the nomenclature that is used in the original publication by Hadley Wickham.</p>
<p>Before we start, a quick warning that I have been struggling with the concept of tidy data. Probably, because I was very much used to collect, process and summarize data in spreadsheets. In addition, I am used to read and present data in a tabular format. It is important to realize that data in the tidy format contains exactly the same information as non-tidy, spreadsheet data, but it is structured in a different way. In fact we can switch back and forth between the two formats with functions that are provided by R.</p>
<div id="quantitative-data-discrete-conditions" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Quantitative data, discrete conditions<a href="read-and-reshape.html#quantitative-data-discrete-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s say that you have measured cell sizes under a number of different experimental conditions and this is stored in an excel spreadsheet. Let’s load the data:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="read-and-reshape.html#cb48-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&#39;Length-wide.xls&#39;</span>)</span>
<span id="cb48-2"><a href="read-and-reshape.html#cb48-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code># A tibble: 10 × 5
   `Condition 1` `Condition 2` `Condition 3` `Condition 4` `Condition 5`
           &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
 1          14.4          19.2          16.6          21.9          18.7
 2          16.2          13.7          13.9          20.2          13.2
 3          11.2          13.2          13.2          22.7          18.1
 4          15.2          20.1          13.7          19            18.2
 5          11.7          21.3          15.9          19.5          15.9
 6          17.5          19.9          13            14.3          28.7
 7          17            20.8          10.8          14            29.6
 8          18.7          18.4          14.9          17.5          13.3
 9          19.1          20.7          14.6          16.5          13.9
10          10.7          19.2          14.2          17.8          13.4</code></pre>
<p>First, we will replace the spaces in the column names. Although this is not strictly necessary, it simplifies handling of the data. We use <code>names()</code> to get the names of the dataframe and <code>str_replace()</code> to replace the space by an underscore:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="read-and-reshape.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(<span class="fu">names</span>(df), <span class="at">pattern =</span> <span class="st">&quot; &quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb50-2"><a href="read-and-reshape.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
  Condition_1 Condition_2 Condition_3 Condition_4 Condition_5
        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1        14.4        19.2        16.6        21.9        18.7
2        16.2        13.7        13.9        20.2        13.2
3        11.2        13.2        13.2        22.7        18.1
4        15.2        20.1        13.7        19          18.2
5        11.7        21.3        15.9        19.5        15.9
6        17.5        19.9        13          14.3        28.7</code></pre>
<p>Now that the column names are fixed, we can restructure the data. The aim is to create a dataframe with one column that specifies the conditions and one column with all the measured values. There is a long history of packages and functions that can be used for restructuring (<code>gather()</code>, <code>melt()</code>). Here we use the most modern function <code>pivot_longer()</code> from the tidyverse package. We need to specify the dataframe, which columns to restructure (specified by <code>everything()</code> here) and the names of the new columns. The current column names will be transferred to a column that is named “condition” and all values will be transferred to a column named “size”.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="read-and-reshape.html#cb52-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;Condition&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Size&quot;</span>)</span>
<span id="cb52-2"><a href="read-and-reshape.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_tidy)</span></code></pre></div>
<pre><code># A tibble: 6 × 2
  Condition    Size
  &lt;chr&gt;       &lt;dbl&gt;
1 Condition_1  14.4
2 Condition_2  19.2
3 Condition_3  16.6
4 Condition_4  21.9
5 Condition_5  18.7
6 Condition_1  16.2</code></pre>
<p>The benefit of this format is that is is now clear what the numbers are.
The most important requirement for tidy data is that each variable occupies only a single column and that each row is an observation.
Let’s save the data in a csv file:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="read-and-reshape.html#cb54-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="st">&#39;Length-tidy.csv&#39;</span>)</span></code></pre></div>
</div>
<div id="multiple-discrete-conditions" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Multiple discrete conditions<a href="read-and-reshape.html#multiple-discrete-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we deal with a more complex spreadsheet that holds data of multiple replicates and two experimental conditions. Note that the data from multiple conditions can be stored in different ways and here we only treat one way. Especially for these kind of datasets, the tidy format is a better, cleaner structure. We will load the data from a repository:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="read-and-reshape.html#cb55-1" aria-hidden="true" tabindex="-1"></a>df_multiheader <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;https://zenodo.org/record/4056966/files/Data-with-replicates.csv&#39;</span>)</span>
<span id="cb55-2"><a href="read-and-reshape.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_multiheader)</span></code></pre></div>
<pre><code>     Control  Control.1  Control.2       Drug     Drug.1     Drug.2
1 Replicate1 Replicate2 Replicate3 Replicate1 Replicate2 Replicate3
2   43.69202   35.43517   27.69333    35.3156   20.54166   16.13286
3   41.85664   38.17644   35.61621   34.81943   20.43263   16.47575
4   49.11707   39.86308   27.20247   30.45615    29.8097   16.49928
5   49.79331    37.5157   39.98903   37.46084   25.94712   18.48844
6   41.54301   42.66665   26.92205   30.25243   22.90337   21.93457</code></pre>
<p>The first row lists the experimental condition and the second row identifies biological replicates. Now, when this is loaded as an ordinary CSV, the first row is the header, but the second row is treated as data. Let’s load the data without flagging a header. We also add the <code>stringsAsFactors = FALSE</code> to make sure that the data is loaded as characters <code>&lt;chr&gt;</code> and not as factors <code>&lt;fctr&gt;</code>. The difference is not obvious, but we run into problems later when we want to convert all the values into actual numbers (which we will do this at the very last step):</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="read-and-reshape.html#cb57-1" aria-hidden="true" tabindex="-1"></a>df_multiheader <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://zenodo.org/record/4056966/files/Data-with-replicates.csv&quot;</span>, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-2"><a href="read-and-reshape.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_multiheader)</span></code></pre></div>
<pre><code>          V1         V2         V3         V4         V5         V6
1    Control    Control    Control       Drug       Drug       Drug
2 Replicate1 Replicate2 Replicate3 Replicate1 Replicate2 Replicate3
3   43.69202   35.43517   27.69333    35.3156   20.54166   16.13286
4   41.85664   38.17644   35.61621   34.81943   20.43263   16.47575
5   49.11707   39.86308   27.20247   30.45615    29.8097   16.49928
6   49.79331    37.5157   39.98903   37.46084   25.94712   18.48844</code></pre>
<p>We’ll load the first row as a vector that contains the name of each column. To this end we select the first row of the dataframe with the brackets <code>[1,]</code>. The result is a dataframe and to turn this into a vector with strings we use <code>unlist()</code>:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="read-and-reshape.html#cb59-1" aria-hidden="true" tabindex="-1"></a>first_row <span class="ot">&lt;-</span> df_multiheader[<span class="dv">1</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="read-and-reshape.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(<span class="at">use.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb59-3"><a href="read-and-reshape.html#cb59-3" aria-hidden="true" tabindex="-1"></a>first_row</span></code></pre></div>
<pre><code>[1] &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Drug&quot;    &quot;Drug&quot;    &quot;Drug&quot;   </code></pre>
<p>We repeat this for the second row:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="read-and-reshape.html#cb61-1" aria-hidden="true" tabindex="-1"></a>second_row <span class="ot">&lt;-</span> df_multiheader[<span class="dv">2</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="read-and-reshape.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(<span class="at">use.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb61-3"><a href="read-and-reshape.html#cb61-3" aria-hidden="true" tabindex="-1"></a>second_row</span></code></pre></div>
<pre><code>[1] &quot;Replicate1&quot; &quot;Replicate2&quot; &quot;Replicate3&quot; &quot;Replicate1&quot; &quot;Replicate2&quot;
[6] &quot;Replicate3&quot;</code></pre>
<p>Next, row 1 and row 2 are removed from the dataframe, keeping only the data:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="read-and-reshape.html#cb63-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_multiheader[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),]</span>
<span id="cb63-2"><a href="read-and-reshape.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>        V1       V2       V3       V4       V5       V6
3 43.69202 35.43517 27.69333  35.3156 20.54166 16.13286
4 41.85664 38.17644 35.61621 34.81943 20.43263 16.47575
5 49.11707 39.86308 27.20247 30.45615  29.8097 16.49928
6 49.79331  37.5157 39.98903 37.46084 25.94712 18.48844
7 41.54301 42.66665 26.92205 30.25243 22.90337 21.93457
8 44.04201 37.10115 18.24681 35.93469 20.10045 22.86391</code></pre>
<p>The labels of the conditions and replicates are combined by pasting them together with an underscore to separate the labes. The result is a single vector with unique labels:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="read-and-reshape.html#cb65-1" aria-hidden="true" tabindex="-1"></a>combined_labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(first_row, second_row, <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb65-2"><a href="read-and-reshape.html#cb65-2" aria-hidden="true" tabindex="-1"></a>combined_labels</span></code></pre></div>
<pre><code>[1] &quot;Control_Replicate1&quot; &quot;Control_Replicate2&quot; &quot;Control_Replicate3&quot;
[4] &quot;Drug_Replicate1&quot;    &quot;Drug_Replicate2&quot;    &quot;Drug_Replicate3&quot;   </code></pre>
<p>Now, we can add these labels as column names to the dataframe:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="read-and-reshape.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> combined_labels</span>
<span id="cb67-2"><a href="read-and-reshape.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>  Control_Replicate1 Control_Replicate2 Control_Replicate3 Drug_Replicate1
3           43.69202           35.43517           27.69333         35.3156
4           41.85664           38.17644           35.61621        34.81943
5           49.11707           39.86308           27.20247        30.45615
6           49.79331            37.5157           39.98903        37.46084
7           41.54301           42.66665           26.92205        30.25243
8           44.04201           37.10115           18.24681        35.93469
  Drug_Replicate2 Drug_Replicate3
3        20.54166        16.13286
4        20.43263        16.47575
5         29.8097        16.49928
6        25.94712        18.48844
7        22.90337        21.93457
8        20.10045        22.86391</code></pre>
<p>To convert this dataframe into a tidy format we use the <code>pivot_longer()</code> function, exactly like we did in the previous example:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="read-and-reshape.html#cb69-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;combined_labels&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Size&quot;</span>)</span>
<span id="cb69-2"><a href="read-and-reshape.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_tidy)</span></code></pre></div>
<pre><code># A tibble: 6 × 2
  combined_labels    Size    
  &lt;chr&gt;              &lt;chr&gt;   
1 Control_Replicate1 43.69202
2 Control_Replicate2 35.43517
3 Control_Replicate3 27.69333
4 Drug_Replicate1    35.3156 
5 Drug_Replicate2    20.54166
6 Drug_Replicate3    16.13286</code></pre>
<p>The dataframe is tidy now, but we need to split the conditions from the replicates in the first column with combined labels:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="read-and-reshape.html#cb71-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> df_tidy <span class="sc">%&gt;%</span> <span class="fu">separate</span>(combined_labels, <span class="fu">c</span>(<span class="st">&#39;Treatment&#39;</span>, <span class="st">&#39;Replicate&#39;</span>))</span>
<span id="cb71-2"><a href="read-and-reshape.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_tidy)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
  Treatment Replicate  Size    
  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;   
1 Control   Replicate1 43.69202
2 Control   Replicate2 35.43517
3 Control   Replicate3 27.69333
4 Drug      Replicate1 35.3156 
5 Drug      Replicate2 20.54166
6 Drug      Replicate3 16.13286</code></pre>
<p>There is still one problem that we need to fix. The values in de the column ‘Size’ are characters <code>&lt;chr&gt;</code>, which means these are strings. Let’s convert the strings to actual numbers:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="read-and-reshape.html#cb73-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Size =</span> <span class="fu">as.numeric</span>(Size))</span></code></pre></div>
<pre><code># A tibble: 300 × 3
   Treatment Replicate   Size
   &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;
 1 Control   Replicate1  43.7
 2 Control   Replicate2  35.4
 3 Control   Replicate3  27.7
 4 Drug      Replicate1  35.3
 5 Drug      Replicate2  20.5
 6 Drug      Replicate3  16.1
 7 Control   Replicate1  41.9
 8 Control   Replicate2  38.2
 9 Control   Replicate3  35.6
10 Drug      Replicate1  34.8
# … with 290 more rows</code></pre>
<p>This kind of data, acquired at different conditions with different replicas is ideally suited for a SuperPlot <a href="https://doi.org/10.1083/jcb.202001064">(Lord et al., 2000)</a>. An example of this kind of data visualization is <a href="complete-protocols.html#protocol-2">Protocol 2</a></p>
</div>
<div id="double-quantitative-data" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Double quantitative data<a href="read-and-reshape.html#double-quantitative-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An example of quantitative continuous data for two variables is when measurements are performed at different concentrations, times or wavelengths. The latter example we have encountered before when spectral data was loaded. Let’s look again at that data and convert it to tidy format.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="read-and-reshape.html#cb75-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&#39;FPbase_Spectra.xlsx&#39;</span>, <span class="at">sheet =</span> <span class="st">&#39;mNeonGreen&#39;</span>)</span>
<span id="cb75-2"><a href="read-and-reshape.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
  Wavelength `mNeonGreen EM` `mNeonGreen EX`
       &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;
1        300              NA              NA
2        301              NA              NA
3        302              NA              NA
4        303              NA              NA
5        304              NA              NA
6        305              NA              NA</code></pre>
<p>Both the Emission (EM) and excitation (EX) data are acquired as a function of wavelength. To convert this data to tidy format, we need to keep a column with wavelength data and we need another column with the spectral data. To achieve this, we will modify the mNeonGreen data and keep the Wavelength data as a column:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="read-and-reshape.html#cb77-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="sc">-</span>Wavelength, <span class="at">names_to =</span> <span class="st">&quot;sample&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;intensity&quot;</span>)</span>
<span id="cb77-2"><a href="read-and-reshape.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_tidy)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
  Wavelength sample        intensity
       &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;
1        300 mNeonGreen EM        NA
2        300 mNeonGreen EX        NA
3        301 mNeonGreen EM        NA
4        301 mNeonGreen EX        NA
5        302 mNeonGreen EM        NA
6        302 mNeonGreen EX        NA</code></pre>
<p>We can now plot the two spectra, which was not possible before the conversion:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="read-and-reshape.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">data=</span>df_tidy,<span class="at">x=</span>Wavelength, <span class="at">y=</span>intensity, <span class="at">color=</span>sample, <span class="at">geom=</span><span class="st">&#39;line&#39;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>A more elaborate example of plotting spectra is given in <a href="complete-protocols.html#protocol-1">Protocol 1</a></p>
</div>
<div id="data-from-multiple-files" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Data from multiple files<a href="read-and-reshape.html#data-from-multiple-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In an earlier example, we have combined the data from multiple files into a single dataframe. Let’s first load it:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="read-and-reshape.html#cb80-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;df_S1P_combined.csv&#39;</span>)</span>
<span id="cb80-2"><a href="read-and-reshape.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>         id      Time    Cell.1    Cell.2    Cell.3    Cell.4    Cell.5
1 Cdc42_S1P 0.0000000 1.0035170 1.0015490 0.9810209 0.9869040 1.0041990
2 Cdc42_S1P 0.1666667 0.9991689 0.9961631 0.9801265 0.9891608 0.9989283
3 Cdc42_S1P 0.3333333 1.0013450 1.0046440 1.0106020 1.0124910 0.9953477
4 Cdc42_S1P 0.5000000 1.0015790 1.0043180 1.0106890 1.0066810 1.0027020
5 Cdc42_S1P 0.6666667 0.9943522 0.9933341 1.0168220 1.0045540 0.9988462
6 Cdc42_S1P 0.8333333 1.0046240 1.0071780 1.0140210 1.0042580 0.9920673
     Cell.6    Cell.7    Cell.8    Cell.9  Cell.10   Cell.11   Cell.12
1 1.0049370 1.0042000 1.0014210 1.0001080 1.000748 1.0015060 1.0057850
2 0.9892894 0.9903881 0.9975485 0.9937496 0.995352 0.9962637 0.9972004
3 1.0104820 1.0140110 1.0016740 1.0003500 1.003132 1.0015520 0.9942397
4 1.0031760 1.0016000 1.0000720 1.0035080 1.000595 1.0017760 1.0035220
5 0.9921757 0.9898673 0.9993021 1.0023010 1.000192 0.9989264 0.9993660
6 1.0081460 1.0075700 0.9985681 1.0013800 1.001741 0.9989417 1.0028090
    Cell.13   Cell.14   Cell.15   Cell.16   Cell.17   Cell.18   Cell.19 Cell.20
1 1.0111880 1.0147230 1.0089390 1.0032410 1.0068720 1.0019290 1.0008660      NA
2 0.9894263 1.0044960 1.0026040 0.9978889 0.9970717 0.9993551 0.9980562      NA
3 0.9921575 1.0073610 1.0029890 1.0009640 0.9984493 0.9968905 0.9966830      NA
4 1.0102150 0.9910634 0.9943020 0.9942904 0.9932356 1.0059050 1.0043110      NA
5 0.9974161 0.9829283 0.9912844 1.0037130 1.0045560 0.9959676 1.0000940      NA
6 1.0070350 0.9790479 0.9861535 1.0059600 1.0065300 1.0070570 1.0049470      NA
  Cell.21 Cell.22 Cell.23 Cell.24 Cell.25 Cell.26 Cell.27 Cell.28 Cell.29
1      NA      NA      NA      NA      NA      NA      NA      NA      NA
2      NA      NA      NA      NA      NA      NA      NA      NA      NA
3      NA      NA      NA      NA      NA      NA      NA      NA      NA
4      NA      NA      NA      NA      NA      NA      NA      NA      NA
5      NA      NA      NA      NA      NA      NA      NA      NA      NA
6      NA      NA      NA      NA      NA      NA      NA      NA      NA
  Cell.30 Cell.31 Cell.32
1      NA      NA      NA
2      NA      NA      NA
3      NA      NA      NA
4      NA      NA      NA
5      NA      NA      NA
6      NA      NA      NA</code></pre>
<p>The data is still in a wide format and all the data that is in a column that starts with ‘Cell’ needs to be combined into a single column. The other columns <code>id</code> and <code>Time</code> need to be excluded from this operation and this is achieved with using the <code>-</code> sign:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="read-and-reshape.html#cb82-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(id, Time), <span class="at">names_to =</span> <span class="st">&quot;object&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;activity&quot;</span>)</span>
<span id="cb82-2"><a href="read-and-reshape.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_tidy)</span></code></pre></div>
<pre><code># A tibble: 6 × 4
  id         Time object activity
  &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
1 Cdc42_S1P     0 Cell.1    1.00 
2 Cdc42_S1P     0 Cell.2    1.00 
3 Cdc42_S1P     0 Cell.3    0.981
4 Cdc42_S1P     0 Cell.4    0.987
5 Cdc42_S1P     0 Cell.5    1.00 
6 Cdc42_S1P     0 Cell.6    1.00 </code></pre>
<p>If desired, the column ‘id’ can be renamed and/or split:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="read-and-reshape.html#cb84-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> df_tidy <span class="sc">%&gt;%</span> <span class="fu">separate</span>(id, <span class="fu">c</span>(<span class="st">&#39;Condition&#39;</span>, <span class="st">&#39;Treatment&#39;</span>))</span>
<span id="cb84-2"><a href="read-and-reshape.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_tidy)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
  Condition Treatment  Time object activity
  &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
1 Cdc42     S1P           0 Cell.1    1.00 
2 Cdc42     S1P           0 Cell.2    1.00 
3 Cdc42     S1P           0 Cell.3    0.981
4 Cdc42     S1P           0 Cell.4    0.987
5 Cdc42     S1P           0 Cell.5    1.00 
6 Cdc42     S1P           0 Cell.6    1.00 </code></pre>
<p>This dataframe is perfectly tidy, but there’s one little improvement that improves the sorting of the objects. The number of cells runs from 1 to 32. When it is sorted, Cell.1 will be followed by Cell.10:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="read-and-reshape.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(df_tidy<span class="sc">$</span>object))</span></code></pre></div>
<pre><code> [1] &quot;Cell.1&quot;  &quot;Cell.10&quot; &quot;Cell.11&quot; &quot;Cell.12&quot; &quot;Cell.13&quot; &quot;Cell.14&quot; &quot;Cell.15&quot;
 [8] &quot;Cell.16&quot; &quot;Cell.17&quot; &quot;Cell.18&quot; &quot;Cell.19&quot; &quot;Cell.2&quot;  &quot;Cell.20&quot; &quot;Cell.21&quot;
[15] &quot;Cell.22&quot; &quot;Cell.23&quot; &quot;Cell.24&quot; &quot;Cell.25&quot; &quot;Cell.26&quot; &quot;Cell.27&quot; &quot;Cell.28&quot;
[22] &quot;Cell.29&quot; &quot;Cell.3&quot;  &quot;Cell.30&quot; &quot;Cell.31&quot; &quot;Cell.32&quot; &quot;Cell.4&quot;  &quot;Cell.5&quot; 
[29] &quot;Cell.6&quot;  &quot;Cell.7&quot;  &quot;Cell.8&quot;  &quot;Cell.9&quot; </code></pre>
<p>To correct this, we need a 0 preceding the single digit numbers, e.g. Cell.01. To do that, we first split the object column into two columns, using the dot as a separator:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="read-and-reshape.html#cb88-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> df_tidy <span class="sc">%&gt;%</span> <span class="fu">separate</span>(<span class="st">&quot;object&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;object&quot;</span>, <span class="st">&quot;number&quot;</span>), <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>)</span></code></pre></div>
<p>Then, we fill up all the number to two digits by adding a 0 in front of all the single digit numbers with the function <code>str_pad()</code>:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="read-and-reshape.html#cb89-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> df_tidy <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">number=</span><span class="fu">str_pad</span>(number, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>))</span></code></pre></div>
<p>We can merge the two columns back together and I changed the seperator to a space:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="read-and-reshape.html#cb90-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> df_tidy <span class="sc">%&gt;%</span> <span class="fu">unite</span>(<span class="st">&quot;object&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;object&quot;</span>, <span class="st">&quot;number&quot;</span>), <span class="at">sep=</span><span class="st">&quot; &quot;</span>)</span>
<span id="cb90-2"><a href="read-and-reshape.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_tidy)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
  Condition Treatment  Time object  activity
  &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
1 Cdc42     S1P           0 Cell 01    1.00 
2 Cdc42     S1P           0 Cell 02    1.00 
3 Cdc42     S1P           0 Cell 03    0.981
4 Cdc42     S1P           0 Cell 04    0.987
5 Cdc42     S1P           0 Cell 05    1.00 
6 Cdc42     S1P           0 Cell 06    1.00 </code></pre>
<p>When the sorting is repeated it looks better:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="read-and-reshape.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(df_tidy<span class="sc">$</span>object))</span></code></pre></div>
<pre><code> [1] &quot;Cell 01&quot; &quot;Cell 02&quot; &quot;Cell 03&quot; &quot;Cell 04&quot; &quot;Cell 05&quot; &quot;Cell 06&quot; &quot;Cell 07&quot;
 [8] &quot;Cell 08&quot; &quot;Cell 09&quot; &quot;Cell 10&quot; &quot;Cell 11&quot; &quot;Cell 12&quot; &quot;Cell 13&quot; &quot;Cell 14&quot;
[15] &quot;Cell 15&quot; &quot;Cell 16&quot; &quot;Cell 17&quot; &quot;Cell 18&quot; &quot;Cell 19&quot; &quot;Cell 20&quot; &quot;Cell 21&quot;
[22] &quot;Cell 22&quot; &quot;Cell 23&quot; &quot;Cell 24&quot; &quot;Cell 25&quot; &quot;Cell 26&quot; &quot;Cell 27&quot; &quot;Cell 28&quot;
[29] &quot;Cell 29&quot; &quot;Cell 30&quot; &quot;Cell 31&quot; &quot;Cell 32&quot;</code></pre>
<p>We will save this tidy dataframe for later use:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="read-and-reshape.html#cb94-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="st">&quot;df_S1P_combined_tidy.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="data-in-96-wells-format-data-in-96-wells-format" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Data in 96-wells format {data-in-96-wells-format}<a href="read-and-reshape.html#data-in-96-wells-format-data-in-96-wells-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data measured on samples in multiwell plates are often stored in a structure that resembles the plate layout. As an example, we use here a dataset from a luciferase experiment, measured with a 96-well plate luminescence reader. The data is stored in a sheet named ‘Results’ in an xlsx file. The cells in which the data is stored are located in F21:Q28. By selecting these cells, only the 96 values that were measured are read:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="read-and-reshape.html#cb95-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&#39;DualLuc_example_data.xlsx&#39;</span>, <span class="at">sheet =</span> <span class="st">&#39;Results&#39;</span>, <span class="at">range =</span> <span class="st">&quot;F21:Q28&quot;</span>, <span class="at">col_names =</span> F)</span></code></pre></div>
<pre><code>New names:
• `` -&gt; `...1`
• `` -&gt; `...2`
• `` -&gt; `...3`
• `` -&gt; `...4`
• `` -&gt; `...5`
• `` -&gt; `...6`
• `` -&gt; `...7`
• `` -&gt; `...8`
• `` -&gt; `...9`
• `` -&gt; `...10`
• `` -&gt; `...11`
• `` -&gt; `...12`</code></pre>
<p>The table-like layout of the data can be changed into a list of 96 values:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="read-and-reshape.html#cb97-1" aria-hidden="true" tabindex="-1"></a>data_as_list <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">unlist</span>(<span class="at">use.names =</span> F)</span></code></pre></div>
<p>It is essential to know how the table is converted and this is done by reading the data from the first column, top to bottom, than the second column, etc.
Knowing this, we can define the wells to which the data belongs, which would be A1, B1, … , G12, H12.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="read-and-reshape.html#cb98-1" aria-hidden="true" tabindex="-1"></a>column <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">each=</span><span class="dv">8</span>)</span>
<span id="cb98-2"><a href="read-and-reshape.html#cb98-2" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],<span class="dv">12</span>)</span>
<span id="cb98-3"><a href="read-and-reshape.html#cb98-3" aria-hidden="true" tabindex="-1"></a>Well <span class="ot">&lt;-</span> <span class="fu">paste0</span>(row,column)</span>
<span id="cb98-4"><a href="read-and-reshape.html#cb98-4" aria-hidden="true" tabindex="-1"></a>Well</span></code></pre></div>
<pre><code> [1] &quot;A1&quot;  &quot;B1&quot;  &quot;C1&quot;  &quot;D1&quot;  &quot;E1&quot;  &quot;F1&quot;  &quot;G1&quot;  &quot;H1&quot;  &quot;A2&quot;  &quot;B2&quot;  &quot;C2&quot;  &quot;D2&quot; 
[13] &quot;E2&quot;  &quot;F2&quot;  &quot;G2&quot;  &quot;H2&quot;  &quot;A3&quot;  &quot;B3&quot;  &quot;C3&quot;  &quot;D3&quot;  &quot;E3&quot;  &quot;F3&quot;  &quot;G3&quot;  &quot;H3&quot; 
[25] &quot;A4&quot;  &quot;B4&quot;  &quot;C4&quot;  &quot;D4&quot;  &quot;E4&quot;  &quot;F4&quot;  &quot;G4&quot;  &quot;H4&quot;  &quot;A5&quot;  &quot;B5&quot;  &quot;C5&quot;  &quot;D5&quot; 
[37] &quot;E5&quot;  &quot;F5&quot;  &quot;G5&quot;  &quot;H5&quot;  &quot;A6&quot;  &quot;B6&quot;  &quot;C6&quot;  &quot;D6&quot;  &quot;E6&quot;  &quot;F6&quot;  &quot;G6&quot;  &quot;H6&quot; 
[49] &quot;A7&quot;  &quot;B7&quot;  &quot;C7&quot;  &quot;D7&quot;  &quot;E7&quot;  &quot;F7&quot;  &quot;G7&quot;  &quot;H7&quot;  &quot;A8&quot;  &quot;B8&quot;  &quot;C8&quot;  &quot;D8&quot; 
[61] &quot;E8&quot;  &quot;F8&quot;  &quot;G8&quot;  &quot;H8&quot;  &quot;A9&quot;  &quot;B9&quot;  &quot;C9&quot;  &quot;D9&quot;  &quot;E9&quot;  &quot;F9&quot;  &quot;G9&quot;  &quot;H9&quot; 
[73] &quot;A10&quot; &quot;B10&quot; &quot;C10&quot; &quot;D10&quot; &quot;E10&quot; &quot;F10&quot; &quot;G10&quot; &quot;H10&quot; &quot;A11&quot; &quot;B11&quot; &quot;C11&quot; &quot;D11&quot;
[85] &quot;E11&quot; &quot;F11&quot; &quot;G11&quot; &quot;H11&quot; &quot;A12&quot; &quot;B12&quot; &quot;C12&quot; &quot;D12&quot; &quot;E12&quot; &quot;F12&quot; &quot;G12&quot; &quot;H12&quot;</code></pre>
<p>We can now generate a dataframe that lists the wells and the values, which is a (luminescence) intensity. We can also add two additional columns that list the row and column information:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="read-and-reshape.html#cb100-1" aria-hidden="true" tabindex="-1"></a>df_tidy_wells <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(column, row, Well, <span class="at">Intensity=</span>data_as_list)</span>
<span id="cb100-2"><a href="read-and-reshape.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_tidy_wells)</span></code></pre></div>
<pre><code>  column row Well Intensity
1      1   A   A1      2010
2      1   B   B1      3210
3      1   C   C1      1965
4      1   D   D1      2381
5      1   E   E1      1292
6      1   F   F1       991</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="read-and-reshape.html#cb102-1" aria-hidden="true" tabindex="-1"></a>df_tidy_wells <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="st">&quot;df_tidy_wells.csv&quot;</span>)</span></code></pre></div>
<p>This concludes the conversion of data from the plate layout into a tidy format. The instructions explained here are used in <a href="complete-protocols.html#protocol-4">Protocol 4</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-the-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
