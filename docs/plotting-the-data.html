<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Plotting the Data | DataViz protocols</title>
  <meta name="description" content="This is an introduction to data visualization protocols for wet lab scientists" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Plotting the Data | DataViz protocols" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an introduction to data visualization protocols for wet lab scientists" />
  <meta name="github-repo" content="JoachimGoedhart/DataViz-protocols" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Plotting the Data | DataViz protocols" />
  
  <meta name="twitter:description" content="This is an introduction to data visualization protocols for wet lab scientists" />
  

<meta name="author" content="Joachim Goedhart" />


<meta name="date" content="2023-02-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="read-and-reshape.html"/>
<link rel="next" href="complete-protocols.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZDBZZ5FR0E"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZDBZZ5FR0E');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DataViz Protocols</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-toast"><i class="fa fa-check"></i>A toast</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#running-r"><i class="fa fa-check"></i><b>1.1</b> Running R</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#using-the-command-line"><i class="fa fa-check"></i><b>1.2</b> Using the command line</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#help"><i class="fa fa-check"></i><b>1.3</b> ?Help</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#installing-packages"><i class="fa fa-check"></i><b>1.4</b> Installing packages</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#multiline-code"><i class="fa fa-check"></i><b>1.5</b> Multiline code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="read-and-reshape.html"><a href="read-and-reshape.html"><i class="fa fa-check"></i><b>2</b> Reading and reshaping data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="read-and-reshape.html"><a href="read-and-reshape.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="read-and-reshape.html"><a href="read-and-reshape.html#types-of-data"><i class="fa fa-check"></i><b>2.2</b> Types of data</a></li>
<li class="chapter" data-level="2.3" data-path="read-and-reshape.html"><a href="read-and-reshape.html#reading-data"><i class="fa fa-check"></i><b>2.3</b> Reading data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="read-and-reshape.html"><a href="read-and-reshape.html#loading-data-from-a-text-or-csv-file"><i class="fa fa-check"></i><b>2.3.1</b> Loading data from a text or csv file</a></li>
<li class="chapter" data-level="2.3.2" data-path="read-and-reshape.html"><a href="read-and-reshape.html#loading-data-from-a-url"><i class="fa fa-check"></i><b>2.3.2</b> Loading data from a URL</a></li>
<li class="chapter" data-level="2.3.3" data-path="read-and-reshape.html"><a href="read-and-reshape.html#retrieving-data-from-excel"><i class="fa fa-check"></i><b>2.3.3</b> Retrieving data from Excel</a></li>
<li class="chapter" data-level="2.3.4" data-path="read-and-reshape.html"><a href="read-and-reshape.html#retrieving-data-from-multiple-files"><i class="fa fa-check"></i><b>2.3.4</b> Retrieving data from multiple files</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="read-and-reshape.html"><a href="read-and-reshape.html#tidy-data"><i class="fa fa-check"></i><b>2.4</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="read-and-reshape.html"><a href="read-and-reshape.html#quantitative-data-discrete-conditions"><i class="fa fa-check"></i><b>2.4.1</b> Quantitative data, discrete conditions</a></li>
<li class="chapter" data-level="2.4.2" data-path="read-and-reshape.html"><a href="read-and-reshape.html#multiple-discrete-conditions"><i class="fa fa-check"></i><b>2.4.2</b> Multiple discrete conditions</a></li>
<li class="chapter" data-level="2.4.3" data-path="read-and-reshape.html"><a href="read-and-reshape.html#double-quantitative-data"><i class="fa fa-check"></i><b>2.4.3</b> Double quantitative data</a></li>
<li class="chapter" data-level="2.4.4" data-path="read-and-reshape.html"><a href="read-and-reshape.html#data-from-multiple-files"><i class="fa fa-check"></i><b>2.4.4</b> Data from multiple files</a></li>
<li class="chapter" data-level="2.4.5" data-path="read-and-reshape.html"><a href="read-and-reshape.html#data-in-96-wells-format-data-in-96-wells-format"><i class="fa fa-check"></i><b>2.4.5</b> Data in 96-wells format {data-in-96-wells-format}</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting-the-data.html"><a href="plotting-the-data.html"><i class="fa fa-check"></i><b>3</b> Plotting the Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#data-over-time-continuous-vs.-continuous"><i class="fa fa-check"></i><b>3.1</b> Data over time (continuous vs. continuous)</a></li>
<li class="chapter" data-level="3.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#discrete-conditions"><i class="fa fa-check"></i><b>3.2</b> Discrete conditions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#x-axis-data-qualitative-versus-quantitative-data"><i class="fa fa-check"></i><b>3.2.1</b> X-axis data: qualitative versus quantitative data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="plotting-the-data.html"><a href="plotting-the-data.html#statistics"><i class="fa fa-check"></i><b>3.3</b> Statistics</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#introduction-1"><i class="fa fa-check"></i><b>3.3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.3.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#data-summaries-directly-added-as-a-plot-layer"><i class="fa fa-check"></i><b>3.3.2</b> Data summaries directly added as a plot layer</a></li>
<li class="chapter" data-level="3.3.3" data-path="plotting-the-data.html"><a href="plotting-the-data.html#data-summaries-from-a-dataframe"><i class="fa fa-check"></i><b>3.3.3</b> Data summaries from a dataframe</a></li>
<li class="chapter" data-level="3.3.4" data-path="plotting-the-data.html"><a href="plotting-the-data.html#data-summaries-for-continuous-x-axis-data"><i class="fa fa-check"></i><b>3.3.4</b> Data summaries for continuous x-axis data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="plotting-the-data.html"><a href="plotting-the-data.html#plot-a-lot---discrete-data"><i class="fa fa-check"></i><b>3.4</b> Plot-a-lot - discrete data</a></li>
<li class="chapter" data-level="3.5" data-path="plotting-the-data.html"><a href="plotting-the-data.html#optimizing-the-data-visualization"><i class="fa fa-check"></i><b>3.5</b> Optimizing the data visualization</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#rotation"><i class="fa fa-check"></i><b>3.5.1</b> Rotation</a></li>
<li class="chapter" data-level="3.5.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#ordering-conditions"><i class="fa fa-check"></i><b>3.5.2</b> Ordering conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="plotting-the-data.html"><a href="plotting-the-data.html#adjusting-the-layout"><i class="fa fa-check"></i><b>3.6</b> Adjusting the layout</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#themes"><i class="fa fa-check"></i><b>3.6.1</b> Themes</a></li>
<li class="chapter" data-level="3.6.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#legend"><i class="fa fa-check"></i><b>3.6.2</b> Legend</a></li>
<li class="chapter" data-level="3.6.3" data-path="plotting-the-data.html"><a href="plotting-the-data.html#grids"><i class="fa fa-check"></i><b>3.6.3</b> Grids</a></li>
<li class="chapter" data-level="3.6.4" data-path="plotting-the-data.html"><a href="plotting-the-data.html#labelstitles"><i class="fa fa-check"></i><b>3.6.4</b> Labels/Titles</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="plotting-the-data.html"><a href="plotting-the-data.html#plot-a-lot---continuous-data"><i class="fa fa-check"></i><b>3.7</b> Plot-a-lot - continuous data</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="plotting-the-data.html"><a href="plotting-the-data.html#small-multiples"><i class="fa fa-check"></i><b>3.7.1</b> Small multiples</a></li>
<li class="chapter" data-level="3.7.2" data-path="plotting-the-data.html"><a href="plotting-the-data.html#heatmaps"><i class="fa fa-check"></i><b>3.7.2</b> Heatmaps</a></li>
<li class="chapter" data-level="3.7.3" data-path="plotting-the-data.html"><a href="plotting-the-data.html#custom-objects"><i class="fa fa-check"></i><b>3.7.3</b> Custom objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="complete-protocols.html"><a href="complete-protocols.html"><i class="fa fa-check"></i><b>4</b> Complete protocols</a>
<ul>
<li class="chapter" data-level="4.1" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-1"><i class="fa fa-check"></i><b>4.1</b> Protocol 1 - Spectra of fluorescent proteins</a></li>
<li class="chapter" data-level="4.2" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-2"><i class="fa fa-check"></i><b>4.2</b> Protocol 2 - A superplot of calcium concentrations</a></li>
<li class="chapter" data-level="4.3" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-3"><i class="fa fa-check"></i><b>4.3</b> Protocol 3 - small multiples of time courses</a></li>
<li class="chapter" data-level="4.4" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-4"><i class="fa fa-check"></i><b>4.4</b> Protocol 4 - Plotting data from a 96-wells experiment</a></li>
<li class="chapter" data-level="4.5" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-5"><i class="fa fa-check"></i><b>4.5</b> Protocol 5 - A map of amino acids</a></li>
<li class="chapter" data-level="4.6" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-6"><i class="fa fa-check"></i><b>4.6</b> Protocol 6 - Heatmap style visualization of timelapse data</a></li>
<li class="chapter" data-level="4.7" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-7"><i class="fa fa-check"></i><b>4.7</b> Protocol 7 - Ridgeline plot</a></li>
<li class="chapter" data-level="4.8" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-8"><i class="fa fa-check"></i><b>4.8</b> Protocol 8 - Plotting data in a 96-wells layout</a></li>
<li class="chapter" data-level="4.9" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-9"><i class="fa fa-check"></i><b>4.9</b> Protocol 9 - A dose response curve with fit</a></li>
<li class="chapter" data-level="4.10" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-10"><i class="fa fa-check"></i><b>4.10</b> Protocol 10 - Plotting data that was harvestd with a Google form</a></li>
<li class="chapter" data-level="4.11" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-11"><i class="fa fa-check"></i><b>4.11</b> Protocol 11 - Plotting time data from a Google form</a></li>
<li class="chapter" data-level="4.12" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-12"><i class="fa fa-check"></i><b>4.12</b> Protocol 12 - Plotting grouped data</a></li>
<li class="chapter" data-level="4.13" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-13"><i class="fa fa-check"></i><b>4.13</b> Protocol 13 - Plotting multiple plots side-by-side</a></li>
<li class="chapter" data-level="4.14" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-14"><i class="fa fa-check"></i><b>4.14</b> Protocol 14 - Volcano plot</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="complete-protocols.html"><a href="complete-protocols.html#step-1---define-thresholds"><i class="fa fa-check"></i><b>4.14.1</b> Step 1 - Define thresholds</a></li>
<li class="chapter" data-level="4.14.2" data-path="complete-protocols.html"><a href="complete-protocols.html#step-2---display-thresholds"><i class="fa fa-check"></i><b>4.14.2</b> Step 2 - Display thresholds</a></li>
<li class="chapter" data-level="4.14.3" data-path="complete-protocols.html"><a href="complete-protocols.html#step-3---filtering-with-thresholds"><i class="fa fa-check"></i><b>4.14.3</b> Step 3 - Filtering with thresholds</a></li>
<li class="chapter" data-level="4.14.4" data-path="complete-protocols.html"><a href="complete-protocols.html#step-4---annotations"><i class="fa fa-check"></i><b>4.14.4</b> Step 4 - Annotations</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-15"><i class="fa fa-check"></i><b>4.15</b> Protocol 15 - Timeline</a>
<ul>
<li class="chapter" data-level="4.15.1" data-path="complete-protocols.html"><a href="complete-protocols.html#improve-the-timeline"><i class="fa fa-check"></i><b>4.15.1</b> Improve the timeline</a></li>
<li class="chapter" data-level="4.15.2" data-path="complete-protocols.html"><a href="complete-protocols.html#add-and-format-text"><i class="fa fa-check"></i><b>4.15.2</b> Add and format text</a></li>
</ul></li>
<li class="chapter" data-level="4.16" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-16"><i class="fa fa-check"></i><b>4.16</b> Protocol 16 - Scatterplots and correlation</a>
<ul>
<li class="chapter" data-level="4.16.1" data-path="complete-protocols.html"><a href="complete-protocols.html#linear-fit"><i class="fa fa-check"></i><b>4.16.1</b> Linear fit</a></li>
<li class="chapter" data-level="4.16.2" data-path="complete-protocols.html"><a href="complete-protocols.html#multiple-scatterplots"><i class="fa fa-check"></i><b>4.16.2</b> Multiple scatterplots</a></li>
<li class="chapter" data-level="4.16.3" data-path="complete-protocols.html"><a href="complete-protocols.html#fit-parameters"><i class="fa fa-check"></i><b>4.16.3</b> Fit parameters</a></li>
</ul></li>
<li class="chapter" data-level="4.17" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-17"><i class="fa fa-check"></i><b>4.17</b> Protocol 17 - Animated plots of data from optogenetics experiments</a></li>
<li class="chapter" data-level="4.18" data-path="complete-protocols.html"><a href="complete-protocols.html#protocol-18"><i class="fa fa-check"></i><b>4.18</b> Protocol 18 - Combining animated plots with a movie</a>
<ul>
<li class="chapter" data-level="4.18.1" data-path="complete-protocols.html"><a href="complete-protocols.html#intermezzo"><i class="fa fa-check"></i><b>4.18.1</b> Intermezzo</a></li>
<li class="chapter" data-level="4.18.2" data-path="complete-protocols.html"><a href="complete-protocols.html#time-for-some-magick"><i class="fa fa-check"></i><b>4.18.2</b> Time for some magick</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="questions-and-answers.html"><a href="questions-and-answers.html"><i class="fa fa-check"></i><b>5</b> Questions and Answers</a>
<ul>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-is-the-difference-between-a-data.frame-and-a-tibble"><i class="fa fa-check"></i>What is the difference between a data.frame and a tibble?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#whats-up-with-spaces-in-variable-names-and-in-files-names"><i class="fa fa-check"></i>What’s up with spaces in variable names and in files names?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-are-the-rules-for-naming-dataframes-or-variables"><i class="fa fa-check"></i>What are the rules for naming dataframes or variables?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-is-the-difference-between---and-for-assigning-variables"><i class="fa fa-check"></i>What is the difference between <code>&lt;-</code> and <code>=</code> for assigning variables?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-does-na-mean-in-a-dataframe"><i class="fa fa-check"></i>What does ‘NA’ mean in a dataframe?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-is-the-beste-way-to-type-a-operator"><i class="fa fa-check"></i>What is the beste way to type a ‘%&gt;%’ operator?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#where-do-i-find-the-example-data"><i class="fa fa-check"></i>Where do I find the example data?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#is-there-a-way-to-re-use-or-adjust-the-protocols"><i class="fa fa-check"></i>Is there a way to re-use or adjust the protocols?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#which-packages-are-included-in-the-tidyverse-package"><i class="fa fa-check"></i>Which packages are included in the <code>{tidyverse}</code> package?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#what-is-the-difference-between-require-and-library-for-loading-a-package"><i class="fa fa-check"></i>What is the difference between <code>require()</code> and <code>library()</code> for loading a package?</a></li>
<li class="chapter" data-level="" data-path="questions-and-answers.html"><a href="questions-and-answers.html#is-it-possible-to-have-interactive-file-selection"><i class="fa fa-check"></i>Is it possible to have interactive file selection?</a></li>
<li><a href="questions-and-answers.html#section" id="toc-section"></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DataViz protocols</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-the-data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Plotting the Data<a href="plotting-the-data.html#plotting-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>When the data is in the right shape, it is ready for plotting. In R there is a dedicated package, ggplot2, for state-of-the-art data visualization. It is part of the ‘tidyverse’ and available when the tidyverse package is loaded. The ggplot2 package is extremely versatile and the plots can be fully customized. This great advantage comes with a disadvantage and that is complexity. Hopefully this chapter will get you started with generating some informative and good-looking plots. In the last chapter with <a href="%7B#complete-protocols%7D">Complete protocols</a> we’ll dive deeper into details.
The default ‘theme’ that is used in ggplot uses a grey plotting area with white gridlines, as can be seen in the plots that were presented in the previous sections. Since I prefer a more classic, white plotting area, I use a different theme from now on. This is theme_light() and it can be set in R (when the tidyverse or ggplot2 package is loaded) as follows:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="plotting-the-data.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_light</span>())</span>
<span id="cb103-2"><a href="plotting-the-data.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<div id="data-over-time-continuous-vs.-continuous" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Data over time (continuous vs. continuous)<a href="plotting-the-data.html#data-over-time-continuous-vs.-continuous" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have previously used a quick plot function <code>qplot()</code> from the ggplot2 package. We will use it here again for showing single cell responses from timelapse imaging. First, we load the (tidy) data and filter the data that reports on Rho and does not have any missing values in the column named activity:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="plotting-the-data.html#cb104-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;df_S1P_combined_tidy.csv&quot;</span>)</span>
<span id="cb104-2"><a href="plotting-the-data.html#cb104-2" aria-hidden="true" tabindex="-1"></a>df_Rho <span class="ot">&lt;-</span> df_tidy <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">&#39;Rho&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(activity))</span></code></pre></div>
<p>We use <code>qplot()</code> to plot the data, by defining the dataframe, and by selecting what data is used for the x- and y-axis. The default geometry (dots) is overridden to show lines and we need to indicate which column defines which is grouped and connected by the line (in this case it is defined by the column object):</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="plotting-the-data.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">data=</span>df_Rho, <span class="at">x=</span>Time, <span class="at">y=</span>activity, <span class="at">geom =</span> <span class="st">&#39;line&#39;</span>, <span class="at">group=</span>object)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>Let’s now change to the <code>ggplot()</code> function, as it allows for more flexibility. First we create an identical plot:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="plotting-the-data.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_Rho, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity, <span class="at">group=</span>object)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>The <code>aes()</code> function is used for mapping “aesthetics”. The aesthetics specify how the variables from the dataframe are used to visualise those variables. In this case the data in the column ‘Time’ is used for mapping the data onto the x-axis and data in the column ‘activity’ is used to map the data onto the y-axis. The <code>geom_line()</code> function specifies that the data is shown as a line and it can be used to set the appearance of the line. We can set the linewidth (size) and the transparency (alpha). Moreover, we can map the different objects to different colors with <code>aes()</code>:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="plotting-the-data.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_Rho, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>object), <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>Since ggplot supports layers, we can add another layer that shows the data as dots using <code>geom_point()</code>. Note that when the definition of the plot spans multiple lines, each line (when followed by another line should end with a <code>+</code>:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="plotting-the-data.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_Rho, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span></span>
<span id="cb108-2"><a href="plotting-the-data.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>object), <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb108-3"><a href="plotting-the-data.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>Note that the order is important, the geometry that is defined by the last function (lines in this example) appears on top in the plot:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="plotting-the-data.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_Rho, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span></span>
<span id="cb109-2"><a href="plotting-the-data.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb109-3"><a href="plotting-the-data.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>object), <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>There is another way to define a plot and add layers. First we define a ggplot object:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="plotting-the-data.html#cb110-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rho, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity))</span></code></pre></div>
<p>We can define layers with different geometries and add these to the ggplot object:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="plotting-the-data.html#cb111-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.8</span>)</span>
<span id="cb111-2"><a href="plotting-the-data.html#cb111-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>object), <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p>Just like the content of a dataframe can be displayed by typing its name, the plot can be shown by typing its name:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="plotting-the-data.html#cb112-1" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>This is convenient and we can use it to experiment with different visualizations. Here I demonstrate this modify&amp;plot approach to remove the legend:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="plotting-the-data.html#cb113-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>Or remove the legend and add a title:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="plotting-the-data.html#cb114-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Single cell responses over time&quot;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>Since <code>ggplot()</code> is part of the tidyverse, it accepts dataframes that are passed through a pipe: <code>%&gt;%</code>
This can be used to select a subset of a dataframe for plotting. Below, the ‘Rac’ condition is filtered from the dataframe <code>df_tidy</code> and passed to ggplot for plotting:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="plotting-the-data.html#cb115-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="plotting-the-data.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">&#39;Rac&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb115-3"><a href="plotting-the-data.html#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>object))</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
<div id="discrete-conditions" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Discrete conditions<a href="plotting-the-data.html#discrete-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we load a dataset that has intensity measurements for 5 different conditions. For each conditions there are three measurements. This would be a typical outcome of the quantification of a western blot for N=3:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="plotting-the-data.html#cb116-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;Low_n_tidy.csv&#39;</span>)</span>
<span id="cb116-2"><a href="plotting-the-data.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>  Condition Intensity
1         A       1.0
2         B      10.3
3         C       5.5
4         D       4.5
5         E       2.3
6         A       1.1</code></pre>
<p>The basic function to plot the data is <code>ggplot()</code>. We supply the name of the dataframe and we define how to ‘map’ the data onto the x- and y-axis. For instance, we can plot the different conditions on the x-axis and show the size measurements on the y-axis:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="plotting-the-data.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>Intensity))</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>This defines the canvas, but does not plot any data yet. To plot the data, we need to define how it will be plotted. We can choose to plot it as dots with the function <code>geom_point()</code>:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="plotting-the-data.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>Within <code>geom_point()</code> we can specify the looks of the dot. For instance, we can change its color, shape and size:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="plotting-the-data.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">shape=</span><span class="dv">18</span> ,<span class="at">size=</span><span class="dv">8</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>One of the issues with data that has low N, is that it may not look ‘impressive’, in the sense that there is lots of empty space on the canvas. This may be a reason to resort to bar graphs. However, bar graphs only show averages, which hinders transparent communication of results (<a href="https://doi.org/10.1371/journal.pbio.1002128" class="uri">https://doi.org/10.1371/journal.pbio.1002128</a>). In situations where a bar graph is added, it has to be defined in the first layer to not overlap with the datapoints:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="plotting-the-data.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>In the default setting, there’s too much emphasis on the bar. This can be changed by formatting the looks of the bars, i.e. by changing the fill color, and the width:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="plotting-the-data.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey80&quot;</span>, <span class="at">width=</span><span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>The overlap of the dots can be reduced by introducing ‘jitter’ which displays the dots with a random offset. Note that the extent of the offset can be controlled and should not exceed the width of the bar. Another way to improve the visibility of overlapping dots is to make the dots transparant. This is controlled by ‘alpha’, which should be a number between 0 (fully transarent, invisible) and 1 (not transparant). In the graph below, both jitter and transparancy are used.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="plotting-the-data.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey80&quot;</span>, <span class="at">width=</span><span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>The jitter is applied randomly. To make a plot with reproducible jitter, one can fix the seed that is used for randomization by providing <code>set.seed()</code> with a number of choice, which fixes the randomness:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="plotting-the-data.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb124-2"><a href="plotting-the-data.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey80&quot;</span>, <span class="at">width=</span><span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<p>In the plot above, the length of the bar reflects the average value. This is only true when the bar starts from 0. Situations in which the length of the bar does not accurately reflect the number are:
- using a linear scale that does not include zero
- cutting the axis
- using a logarithmic scale, which (per definition) does not include zero.</p>
<p>An example is shown below, where the logarithmic scale and limites are defined in by the <code>scale_y_log10()</code> function. Due to the non-linear scale, the length of the bar is not proportional to the value (the average) it reflects. This leads to misinterpretation of the data.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="plotting-the-data.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey80&quot;</span>, <span class="at">width=</span><span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">12</span>)) </span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<div id="x-axis-data-qualitative-versus-quantitative-data" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> X-axis data: qualitative versus quantitative data<a href="plotting-the-data.html#x-axis-data-qualitative-versus-quantitative-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that the data comes from an experiment in which the data are measured at different time points. First we define a vector that defines the timepoints: e.g. 0, 1, 2, 5, 10:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="plotting-the-data.html#cb126-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span></code></pre></div>
<p>We need to repeat these timepoints three times, once for each replicate:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="plotting-the-data.html#cb127-1" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">rep</span>(t,<span class="dv">3</span>)</span></code></pre></div>
<p>Now we can add the vector to the dataframe:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="plotting-the-data.html#cb128-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time=</span>t3)</span></code></pre></div>
<p>And plot the activity for the different time points:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="plotting-the-data.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey80&quot;</span>, <span class="at">width=</span><span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<p>This graph looks different because we it has numbers on the x-axis. The numbers are treated as ‘continuous quantitative data’ and the data is positioned according to the values. To treat the numbers as conditions or labels we need to convert them to qualitative data. This class of data is called <code>factors</code> in R. We can verify the class of data by selecting the column using the <code>class()</code> function. Here we select the third column of the dataframe to check its class:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="plotting-the-data.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df[,<span class="dv">3</span>])</span></code></pre></div>
<pre><code>[1] &quot;numeric&quot;</code></pre>
<p>Now we convert the column ‘Time’ to the class factor:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="plotting-the-data.html#cb132-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time=</span><span class="fu">as.factor</span>(Time))</span></code></pre></div>
<p>Let’s verify that the class is changed:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="plotting-the-data.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df[,<span class="dv">3</span>])</span></code></pre></div>
<pre><code>[1] &quot;factor&quot;</code></pre>
<p>We use the same line of code to plot the data, and the graph will look similar to the graph that used the conditions indicated with letters.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="plotting-the-data.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey80&quot;</span>, <span class="at">width=</span><span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<p>Whether you treat the numbers on the x-axis as labels or values determines on the data and the message that you want to convey. If it is important to know when the highest activity occurs, it may not matter that the points are not equidistant (as in this example). In fact the data in the plot may better align with the lanes of a blot (which are also equidistant) from which the data are quantified . On the other hand, if you are interested in the dynamics of the activity, the timepoints on the x-axis should reflect the actual values to enable proper interpretation.</p>
</div>
</div>
<div id="statistics" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Statistics<a href="plotting-the-data.html#statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction-1" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Introduction<a href="plotting-the-data.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Thus far, we were mainly concerned with plotting the data. But plots with scientific data often feature some kind of statistics. Next to the mean or median, error bars are used to summarize variability or to reflect the uncertainty of the measurement.</p>
<div class="alert alert-info">
<p><strong>Intermezzo: Descriptive vs Inferential Statistics</strong>
It is a good idea to reflect on the reason to display statistics and it is essential to understand that you can choose between descriptive and inferential statistics. The descriptive statistics are used to summarize the data. Examples of descriptive statistics are the mean, median and standard deviation. Boxplots also display descriptive statistics.
Inferential statistics are used to make ‘inferences’ or, in other words, generalize the data that are measured to the population it was sampled from. It is used to compare experiments and make predictions. Examples of inferential statistics are standard error of the mean and confidence intervals.</p>
</div>
<p>There are (at least) two ways to overlay statistics in a plot. The first way is demonstrated in the previous section, where a layer with the statistics (bar) was directly added to the plot. Below, we take this strategy a step further to display the standard deviation.</p>
</div>
<div id="data-summaries-directly-added-as-a-plot-layer" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Data summaries directly added as a plot layer<a href="plotting-the-data.html#data-summaries-directly-added-as-a-plot-layer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the code below the <code>stat_summary()</code> defines a layer with statistics. The <code>fun=mean</code> statement indicates that the function <code>mean()</code> should be applied to every condition on the x-axis:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="plotting-the-data.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb136-2"><a href="plotting-the-data.html#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb136-3"><a href="plotting-the-data.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom=</span><span class="st">&#39;point&#39;</span>, <span class="at">size=</span><span class="dv">8</span>, <span class="at">color=</span><span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<p>This is pretty ugly and it is more common to indicate the mean (or median) with a horizontal line. This can be done by specifying the shape of the point:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="plotting-the-data.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb137-2"><a href="plotting-the-data.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb137-3"><a href="plotting-the-data.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom=</span><span class="st">&#39;point&#39;</span>, <span class="at">shape=</span><span class="dv">95</span>, <span class="at">size=</span><span class="dv">24</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<p>This works, but it doesn’t allow us to specify the width and the thickness of the line. To have better control over the line we turn to another ‘geom’, <code>geom_errorbar()</code>. This function is actually used to display errorbars, but if we only set one value for the min and max, it allows us to display the mean. We can change the looks of the horizontal bar by changing the width and the size. The latter defines the thickness of the line.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="plotting-the-data.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="plotting-the-data.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb138-3"><a href="plotting-the-data.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.min=</span>mean, <span class="at">fun.max=</span>mean, <span class="at">geom=</span><span class="st">&#39;errorbar&#39;</span>, <span class="at">width=</span><span class="fl">0.6</span>, <span class="at">size =</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p>We can also indicate the standard deviation (SD), but we need to define a custom function to calculate the position of the upper and lower limit of the errorbar. That is, we need to display mean+SD and mean-SD for each condition. The code for the function that defines the lower limit is: <code>function(y) {mean(y)-sd(y)}</code> and for the upper limit it is: <code>function(y) {mean(y)+sd(y)}</code>
Here we go (note that the width is set to a smaller value):</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="plotting-the-data.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb139-2"><a href="plotting-the-data.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb139-3"><a href="plotting-the-data.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.min=</span><span class="cf">function</span>(y) {<span class="fu">mean</span>(y) <span class="sc">-</span> <span class="fu">sd</span>(y)}, <span class="at">fun.max=</span><span class="cf">function</span>(y) {<span class="fu">mean</span>(y) <span class="sc">+</span> <span class="fu">sd</span>(y)}, <span class="at">geom=</span><span class="st">&#39;errorbar&#39;</span>, <span class="at">width=</span><span class="fl">0.3</span>, <span class="at">size =</span><span class="dv">1</span>) </span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<p>By combing the layers that define the mean and de sd, we can show both:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="plotting-the-data.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb140-2"><a href="plotting-the-data.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb140-3"><a href="plotting-the-data.html#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.min=</span><span class="cf">function</span>(y) {<span class="fu">mean</span>(y) <span class="sc">-</span> <span class="fu">sd</span>(y)}, <span class="at">fun.max=</span><span class="cf">function</span>(y) {<span class="fu">mean</span>(y) <span class="sc">+</span> <span class="fu">sd</span>(y)}, <span class="at">geom=</span><span class="st">&#39;errorbar&#39;</span>, <span class="at">width=</span><span class="fl">0.3</span>, <span class="at">size =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb140-4"><a href="plotting-the-data.html#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.min=</span>mean, <span class="at">fun.max=</span>mean, <span class="at">geom=</span><span class="st">&#39;errorbar&#39;</span>, <span class="at">width=</span><span class="fl">0.6</span>, <span class="at">size =</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<p>Finally, an example that displays the 95% confidence intervals:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="plotting-the-data.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb141-2"><a href="plotting-the-data.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb141-3"><a href="plotting-the-data.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.min=</span><span class="cf">function</span>(y) {<span class="fu">mean</span>(y) <span class="sc">-</span> <span class="fu">qt</span>((<span class="dv">1</span><span class="fl">-0.95</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">length</span>(y) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(y) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(y) <span class="sc">-</span> <span class="dv">1</span>)}, <span class="at">fun.max=</span><span class="cf">function</span>(y) {<span class="fu">mean</span>(y) <span class="sc">+</span> <span class="fu">qt</span>((<span class="dv">1</span><span class="fl">-0.95</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">length</span>(y) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(y) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(y) <span class="sc">-</span> <span class="dv">1</span>)}, <span class="at">geom=</span><span class="st">&#39;errorbar&#39;</span>, <span class="at">width=</span><span class="fl">0.3</span>, <span class="at">size =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb141-4"><a href="plotting-the-data.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.min=</span>mean, <span class="at">fun.max=</span>mean, <span class="at">geom=</span><span class="st">&#39;errorbar&#39;</span>, <span class="at">width=</span><span class="fl">0.6</span>, <span class="at">size =</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>This method works, but the code to generate this graph is pretty long and the definition of the function make it difficult to follow and understand what’s going on. In addition, the values for the statistics are not accessible. To solve these issue, I will demonstrate below a more intuitive way to calculate and display the statistics.</p>
</div>
<div id="data-summaries-from-a-dataframe" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Data summaries from a dataframe<a href="plotting-the-data.html#data-summaries-from-a-dataframe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We start out from the same data and dataframe. First, we calculate the statistics and assign the values to a new dataframe. To this end, we use the <code>summarise()</code> function for each condition (Time in this dataset) which we indicate by the use of <code>group_by()</code>:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="plotting-the-data.html#cb142-1" aria-hidden="true" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(Intensity), <span class="at">sd=</span><span class="fu">sd</span>(Intensity))</span>
<span id="cb142-2"><a href="plotting-the-data.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_summary)</span></code></pre></div>
<pre><code># A tibble: 5 × 4
  Time      n  mean    sd
  &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 0         3  1    0.1  
2 1         3  9.83 0.451
3 2         3  6.1  1.22 
4 5         3  4.67 0.208
5 10        3  3.17 0.850</code></pre>
<p>This new dataframe can be used as source for displaying the statistics. Note that we need to indicate the df_summary dataframe for each layer:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="plotting-the-data.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span></span>
<span id="cb144-2"><a href="plotting-the-data.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Intensity),<span class="at">size=</span><span class="dv">4</span>, <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb144-3"><a href="plotting-the-data.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>df_summary, <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">ymin=</span>(mean<span class="sc">-</span>sd), <span class="at">ymax=</span>(mean<span class="sc">+</span>sd)), <span class="at">width=</span><span class="fl">0.3</span>, <span class="at">size =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb144-4"><a href="plotting-the-data.html#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>df_summary, <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">ymin=</span>(mean), <span class="at">ymax=</span>(mean)), <span class="at">width=</span><span class="fl">0.6</span>, <span class="at">size =</span><span class="dv">1</span>) </span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<p>How about other stats? If we calculate other stats like sem, MAD and confidence intervals and store those in a dataframe, we can retrieve those for plotting as well. Below the code for the calculation of the most common statistics is presented. There is no function to calculare sem or the confidence interval and so we calulate those using <code>mutate()</code>. The confidence levels is set to 95%:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="plotting-the-data.html#cb145-1" aria-hidden="true" tabindex="-1"></a>Confidence_level <span class="ot">=</span> <span class="fl">0.95</span></span>
<span id="cb145-2"><a href="plotting-the-data.html#cb145-2" aria-hidden="true" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb145-3"><a href="plotting-the-data.html#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb145-4"><a href="plotting-the-data.html#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(Intensity), <span class="at">median=</span><span class="fu">median</span>(Intensity), <span class="at">sd=</span><span class="fu">sd</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb145-5"><a href="plotting-the-data.html#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sem=</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-1</span>),</span>
<span id="cb145-6"><a href="plotting-the-data.html#cb145-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_CI_lo =</span> mean <span class="sc">+</span> <span class="fu">qt</span>((<span class="dv">1</span><span class="sc">-</span>Confidence_level)<span class="sc">/</span><span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sem,</span>
<span id="cb145-7"><a href="plotting-the-data.html#cb145-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_CI_hi =</span> mean <span class="sc">-</span> <span class="fu">qt</span>((<span class="dv">1</span><span class="sc">-</span>Confidence_level)<span class="sc">/</span><span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sem</span>
<span id="cb145-8"><a href="plotting-the-data.html#cb145-8" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb145-9"><a href="plotting-the-data.html#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_summary)</span></code></pre></div>
<pre><code># A tibble: 5 × 8
  Time      n  mean median    sd    sem mean_CI_lo mean_CI_hi
  &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 0         3  1       1   0.1   0.0707      0.696       1.30
2 1         3  9.83    9.8 0.451 0.319       8.46       11.2 
3 2         3  6.1     5.5 1.22  0.860       2.40        9.80
4 5         3  4.67    4.6 0.208 0.147       4.03        5.3 
5 10        3  3.17    3.2 0.850 0.601       0.579       5.75</code></pre>
<p>In principle the code for plotting the error bars that reflect the standard deviations (or sem) can be simplified if the upper and lower limit are calculated, similar to the example shown above for the 95% confidence intervals.</p>
</div>
<div id="data-summaries-for-continuous-x-axis-data" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Data summaries for continuous x-axis data<a href="plotting-the-data.html#data-summaries-for-continuous-x-axis-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s revisit the data from the time-course of Rho GTPase activity that we’ve looked at earlier:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="plotting-the-data.html#cb147-1" aria-hidden="true" tabindex="-1"></a>df_tidy <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;df_S1P_combined_tidy.csv&quot;</span>)</span>
<span id="cb147-2"><a href="plotting-the-data.html#cb147-2" aria-hidden="true" tabindex="-1"></a>df_Rho <span class="ot">&lt;-</span> df_tidy <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">&#39;Rho&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(activity))</span></code></pre></div>
<p>Calculate the statistics for each time point:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="plotting-the-data.html#cb148-1" aria-hidden="true" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df_Rho <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb148-2"><a href="plotting-the-data.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(activity), <span class="at">median=</span><span class="fu">median</span>(activity), <span class="at">sd=</span><span class="fu">sd</span>(activity)) <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="plotting-the-data.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sem=</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-1</span>),</span>
<span id="cb148-4"><a href="plotting-the-data.html#cb148-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_CI_lo =</span> mean <span class="sc">+</span> <span class="fu">qt</span>((<span class="dv">1</span><span class="sc">-</span>Confidence_level)<span class="sc">/</span><span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sem,</span>
<span id="cb148-5"><a href="plotting-the-data.html#cb148-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_CI_hi =</span> mean <span class="sc">-</span> <span class="fu">qt</span>((<span class="dv">1</span><span class="sc">-</span>Confidence_level)<span class="sc">/</span><span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sem</span>
<span id="cb148-6"><a href="plotting-the-data.html#cb148-6" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb148-7"><a href="plotting-the-data.html#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_summary)</span></code></pre></div>
<pre><code># A tibble: 6 × 8
   Time     n  mean median      sd      sem mean_CI_lo mean_CI_hi
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 0        12 0.998  0.997 0.00477 0.00144       0.995       1.00
2 0.167    12 1.00   1.00  0.00615 0.00186       0.999       1.01
3 0.333    12 0.998  0.998 0.00260 0.000783      0.996       1.00
4 0.5      12 0.999  0.998 0.00657 0.00198       0.995       1.00
5 0.667    12 1.00   1.00  0.00703 0.00212       0.998       1.01
6 0.833    12 1.00   1.00  0.00741 0.00223       0.998       1.01</code></pre>
<p>With this data summary it is possible to depict the 95% confidence interval as error bars:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="plotting-the-data.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_Rho) <span class="sc">+</span></span>
<span id="cb150-2"><a href="plotting-the-data.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity, <span class="at">color=</span>object),<span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb150-3"><a href="plotting-the-data.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>df_summary, <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">ymin=</span>mean_CI_lo, <span class="at">ymax=</span>(mean_CI_hi)), <span class="at">width=</span><span class="fl">0.3</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<p>It works, but it is also quite messy. Luckily ggplot has a more elegant solution and that’s <code>geom_ribbon()</code>:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="plotting-the-data.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_Rho) <span class="sc">+</span></span>
<span id="cb151-2"><a href="plotting-the-data.html#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity, <span class="at">group=</span>object),<span class="at">size=</span>.<span class="dv">5</span>, <span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb151-3"><a href="plotting-the-data.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>df_summary, <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">ymin=</span>mean_CI_lo, <span class="at">ymax=</span>(mean_CI_hi)), <span class="at">fill=</span><span class="st">&#39;blue&#39;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<p>Note that I also removed the color of the individual lines, as it is more about the ensemble and it’s average than the individual line. Adding a line to reflect the average is pretty straightforward:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="plotting-the-data.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_Rho) <span class="sc">+</span></span>
<span id="cb152-2"><a href="plotting-the-data.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity, <span class="at">group=</span>object),<span class="at">size=</span>.<span class="dv">5</span>, <span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb152-3"><a href="plotting-the-data.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>df_summary, <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">ymin=</span>mean_CI_lo, <span class="at">ymax=</span>(mean_CI_hi)), <span class="at">fill=</span><span class="st">&#39;blue&#39;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb152-4"><a href="plotting-the-data.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>df_summary, <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>mean), <span class="at">color=</span><span class="st">&#39;blue&#39;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
</div>
<div id="plot-a-lot---discrete-data" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Plot-a-lot - discrete data<a href="plotting-the-data.html#plot-a-lot---discrete-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Other data summaries that are often depicted in plots are boxplots and violinplots. These are not suited for data with low n, as in the previous example. The reason is that the boxplot is defined by five values, i.e. the median (the central line), the interquartile range, IQR (the two limits of the box) and the endpoints of the two lines, also known as whiskers. It makes no sense to use a boxplot for n=5, since it does not add any new information. There is no hard cut-off, but in my opinion boxplots make sense when you have 10 or more datapoints per condition.
Although the boxplot is a good data summary for normally distributed and skewed data distributions, it doesn’t capture the underlying distribution well when it is bi- or multimodal. In these cases, a violin plot is better suited.
The box- and violinplot are easily added as a layer as they are defined by specific functions, <code>geom_boxplot()</code> and <code>geom_violin()</code>.</p>
<p>First, let’s load a dataset with larger n. The function <code>summary()</code> provides a quick overview of the data:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="plotting-the-data.html#cb153-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;Area_tidy.csv&#39;</span>)</span>
<span id="cb153-2"><a href="plotting-the-data.html#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code></pre></div>
<pre><code>  Condition             value       
 Length:283         Min.   : 477.2  
 Class :character   1st Qu.:1152.1  
 Mode  :character   Median :1490.9  
                    Mean   :1567.8  
                    3rd Qu.:1838.1  
                    Max.   :3906.7  </code></pre>
<p>There are three conditions, with relative large n. Let’s plot the data:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="plotting-the-data.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>Adding a boxplot:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="plotting-the-data.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>The geom_boxplot displays outliers (data beyond the whiskers). This is clear when only the boxplot is shown:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="plotting-the-data.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<p>When the data is displayed together with the boxplot, the outliers need to be removed to avoid duplication. And to make sure that the data is visibel and not hidden by the boxplot, we can either change the order of the layers or remove the white color that is used to fill the box:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="plotting-the-data.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb158-2"><a href="plotting-the-data.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb158-3"><a href="plotting-the-data.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">outlier.color =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<p>In case a boxplot is used as summary, it may be useful to have the values of Q1, Q3 and the interquartile range. The code shown below can be used to calculate all these paramters and also includes the median absolute deviation (MAD) as a robust measure of variability:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="plotting-the-data.html#cb159-1" aria-hidden="true" tabindex="-1"></a>Confidence_level <span class="ot">=</span> <span class="fl">0.95</span></span>
<span id="cb159-2"><a href="plotting-the-data.html#cb159-2" aria-hidden="true" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="plotting-the-data.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span></span>
<span id="cb159-4"><a href="plotting-the-data.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(value), <span class="at">median=</span><span class="fu">median</span>(value), <span class="at">sd=</span><span class="fu">sd</span>(value),</span>
<span id="cb159-5"><a href="plotting-the-data.html#cb159-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAD=</span><span class="fu">mad</span>(value, <span class="at">constant=</span><span class="dv">1</span>),</span>
<span id="cb159-6"><a href="plotting-the-data.html#cb159-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">IQR=</span><span class="fu">IQR</span>(value),</span>
<span id="cb159-7"><a href="plotting-the-data.html#cb159-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q1=</span><span class="fu">quantile</span>(value, <span class="at">probs=</span><span class="fl">0.25</span>),</span>
<span id="cb159-8"><a href="plotting-the-data.html#cb159-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q3=</span><span class="fu">quantile</span>(value, <span class="at">probs=</span><span class="fl">0.75</span>))</span>
<span id="cb159-9"><a href="plotting-the-data.html#cb159-9" aria-hidden="true" tabindex="-1"></a>df_summary</span></code></pre></div>
<pre><code># A tibble: 3 × 9
  Condition     n  mean median    sd   MAD   IQR    Q1    Q3
  &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 LARG         99 1361.  1271.  486.  250.  485. 1053. 1538.
2 TIAM        110 1808.  1705.  704.  416.  818. 1293. 2112.
3 wt           74 1487.  1509.  459.  333.  662. 1158. 1821.</code></pre>
<p>Display of a violinplot in addition to the data:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="plotting-the-data.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb161-2"><a href="plotting-the-data.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb161-3"><a href="plotting-the-data.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
<p>Personally, I like the combination of data and violinplot, but the jitter can make the plot look messy. There are packages that enable the plotting of the data according to its distribution. There is <code>geom_sina()</code> from the {ggforce} package and <code>geom_quasirandom()</code> from the {ggbeeswarm} package:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="plotting-the-data.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb162-2"><a href="plotting-the-data.html#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb162-3"><a href="plotting-the-data.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb162-4"><a href="plotting-the-data.html#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>Sometimes, you find examples of boxplots overlayed on violin plots, like this (and note that we have filled the violins with a unique color for each condition):</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="plotting-the-data.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb163-2"><a href="plotting-the-data.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Condition), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb163-3"><a href="plotting-the-data.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">outlier.color =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<p>Note that <code>geom_quasirandom()</code> can generate plots with excessive overlap between data points when there’s large amounts of data. In some cases this can be solved by increasing the transparency (by decreasing alpha). Another option is to use <code>geom_beeswarm()</code>, which does not allow overlap of the points. I have a preference for showing the actual data, but for large n the violinplot may better convey the message of the data than a cluttered plot that shows a lot of dots.</p>
</div>
<div id="optimizing-the-data-visualization" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Optimizing the data visualization<a href="plotting-the-data.html#optimizing-the-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="rotation" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Rotation<a href="plotting-the-data.html#rotation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rotating a plot by 90 degrees can be surprisingly effective. Especially when the labels that are used for the x-axis are so long that they need to be rotated, it is better to rotate the plot. This improves the readability of the numbers and labels on both the x- and y-axis and avoids the need of tilting your head.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="plotting-the-data.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb164-2"><a href="plotting-the-data.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb164-3"><a href="plotting-the-data.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb164-4"><a href="plotting-the-data.html#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb164-5"><a href="plotting-the-data.html#cb164-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<p>An example of how to further tweak a 90˚ rotated plots is given in <a href="complete-protocols.html#protocol-2">Protocol 2</a></p>
</div>
<div id="ordering-conditions" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Ordering conditions<a href="plotting-the-data.html#ordering-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The order of the conditions used for the x-axis (for discrete conditions) is numeric and alphabetic. In case of a large number of conditions, it can help to sort these according to the median or mean value. This requires another order of the factors. To check the order of the factors in the dataframe we use:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="plotting-the-data.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>Condition)</span></code></pre></div>
<pre><code>NULL</code></pre>
<p>Now, we change the order, sorting the factors according to the median of “value” and we verify the order:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="plotting-the-data.html#cb167-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Condition =</span> <span class="fu">fct_reorder</span>(Condition, value, <span class="at">.fun=</span><span class="st">&#39;median&#39;</span>))</span>
<span id="cb167-2"><a href="plotting-the-data.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>Condition)</span></code></pre></div>
<pre><code>[1] &quot;LARG&quot; &quot;wt&quot;   &quot;TIAM&quot;</code></pre>
<p>Let’s plot the data:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="plotting-the-data.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb169-2"><a href="plotting-the-data.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb169-3"><a href="plotting-the-data.html#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
<p>The factors on the x-axis are now sorted according to the median of value. It is also possible to manually set the sequence, in this example the order is set to wt, LARG, TIAM:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="plotting-the-data.html#cb170-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Condition =</span> <span class="fu">fct_relevel</span>(Condition, <span class="fu">c</span>(<span class="st">&quot;LARG&quot;</span>, <span class="st">&quot;TIAM&quot;</span>, <span class="st">&quot;wt&quot;</span>)))</span>
<span id="cb170-2"><a href="plotting-the-data.html#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="plotting-the-data.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb170-4"><a href="plotting-the-data.html#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb170-5"><a href="plotting-the-data.html#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<p>In the examples above, we have modified the dataframe, since we used <code>mutate()</code> to change the order. To set the order for plotting without altering the dataframe we can define the reordering within ggplot:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="plotting-the-data.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(Condition, value, <span class="at">.fun=</span><span class="st">&#39;median&#39;</span>), <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb171-2"><a href="plotting-the-data.html#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb171-3"><a href="plotting-the-data.html#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<p>Alternatively, we can use the pipe operator to feed the data in the reordering function and then use the reordered dataframe for plotting:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="plotting-the-data.html#cb172-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Condition =</span> <span class="fu">fct_reorder</span>(Condition, value, <span class="at">.fun=</span><span class="st">&#39;median&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb172-2"><a href="plotting-the-data.html#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb172-3"><a href="plotting-the-data.html#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb172-4"><a href="plotting-the-data.html#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
<p>We can check that the order of the levels in the dataframe has not changed and differs from the order in the plot:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="plotting-the-data.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df<span class="sc">$</span>Condition)</span></code></pre></div>
<pre><code>[1] &quot;LARG&quot; &quot;TIAM&quot; &quot;wt&quot;  </code></pre>
</div>
</div>
<div id="adjusting-the-layout" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Adjusting the layout<a href="plotting-the-data.html#adjusting-the-layout" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Details matter, also in data visualization. Editing labels, adding titles or annotating data can make the difference between a poor and a clear data visualization. Although it can be quicker and easier to edit a plot with software that deals with vectors, it is not reproducible. And when you need to change the graph, the editing starts all over again. Luckily, with ggplot2, you have full control over every element.
A lot of elements are controlled by the function <code>theme()</code>, and examples are the label size and color, the grid, the legend style and the color of the plot elements. This level of control offers great power, but it can be quite daunting (and non-intuitive) for new users. We discuss a couple of straightforward manipulations of the theme below. More detailed modifications of the layout will be showcased in the chapter with <a href="complete-protocols.html#complete-protocols">Complete Protocols</a>.</p>
<div id="themes" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Themes<a href="plotting-the-data.html#themes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s look at a violinplot and we plot it with the default theme, which has a grey background:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="plotting-the-data.html#cb175-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Condition, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb175-2"><a href="plotting-the-data.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Condition), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb175-3"><a href="plotting-the-data.html#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">outlier.color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb175-4"><a href="plotting-the-data.html#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>()</span>
<span id="cb175-5"><a href="plotting-the-data.html#cb175-5" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<p>The default theme is OK-ish and we can change it to one of the other themes that are available in the ggplot2 package, for instance <code>theme_classic()</code>:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="plotting-the-data.html#cb176-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
<p>The ggplot2 package has a default dark theme, but that only generate a dark background in the plot area. I made a customized theme <code>theme_darker()</code> for plots on dark background, e.g. black slides. It needs to be loaded with the <code>source()</code> function and then it can be applied:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="plotting-the-data.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/JoachimGoedhart/PlotTwist/master/themes.R&quot;</span>)</span>
<span id="cb177-2"><a href="plotting-the-data.html#cb177-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_darker</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<p>Finally, we can modify the text size of all text elements:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="plotting-the-data.html#cb178-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<p>To reset the theme to the default that is used throughout the book:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="plotting-the-data.html#cb179-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code></pre></div>
</div>
<div id="legend" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Legend<a href="plotting-the-data.html#legend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The legend can be controlled through the <code>theme()</code> function. Legends are automatically created when different colors or shapes are used. One example is the plot below, where different conditions are shown in different colors. To change the style, we define the plot object p:</p>
<p>To remove the legend we use:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="plotting-the-data.html#cb180-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
<p>Other options are “top”, “left”, “bottom” and (the default) “right”. The items of the legend can also be displayed horizontally, which is a nice fit when the legend is shown on top of the plot:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="plotting-the-data.html#cb181-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>To left align the legend:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="plotting-the-data.html#cb182-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="at">legend.justification=</span><span class="st">&#39;left&#39;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
</div>
<div id="grids" class="section level3 hasAnchor" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Grids<a href="plotting-the-data.html#grids" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I am not a big fan of grids, so I often remove it:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="plotting-the-data.html#cb183-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<p>To only remove the vertical grid and make the horizontal grid more pronounced:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="plotting-the-data.html#cb184-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb184-2"><a href="plotting-the-data.html#cb184-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&#39;grey30&#39;</span>),</span>
<span id="cb184-3"><a href="plotting-the-data.html#cb184-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">size=</span><span class="fl">0.2</span>, <span class="at">color=</span><span class="st">&#39;grey30&#39;</span>)</span>
<span id="cb184-4"><a href="plotting-the-data.html#cb184-4" aria-hidden="true" tabindex="-1"></a>          )</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
</div>
<div id="labelstitles" class="section level3 hasAnchor" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> Labels/Titles<a href="plotting-the-data.html#labelstitles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Clear labeling aids the interpretation of the plot. The actual labels and titles are changed or added with the function <code>labs()</code> and their style is controled with the <code>theme()</code> function.</p>
<p>Let’s first look at the labels. The titles of the axes and legend are retrieved from the column names in the dataframe. To adjust the axis labels with <code>labs()</code>:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="plotting-the-data.html#cb185-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Perturbation&#39;</span>, <span class="at">y=</span><span class="st">&#39;Area [µm]&#39;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>Note that the title of the legend is not changed. To change the legend title we need to supply a label for ‘fill’, since the legend in this example indicates the color that was used to ‘fill’ the violin plots:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="plotting-the-data.html#cb186-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Perturbation&#39;</span>, <span class="at">y=</span><span class="st">&#39;Area [µm]&#39;</span>, <span class="at">fill=</span><span class="st">&#39;Perturbation:&#39;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<p>A title, subtitle and caption can also be added with <code>labs()</code>:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="plotting-the-data.html#cb187-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Condition&#39;</span>,</span>
<span id="cb187-2"><a href="plotting-the-data.html#cb187-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&#39;Area [µm]&#39;</span>,</span>
<span id="cb187-3"><a href="plotting-the-data.html#cb187-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">title=</span><span class="st">&#39;This is the title...&#39;</span>,</span>
<span id="cb187-4"><a href="plotting-the-data.html#cb187-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle=</span><span class="st">&#39;...and this is the subtitle&#39;</span>,</span>
<span id="cb187-5"><a href="plotting-the-data.html#cb187-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&#39;A caption is text at the bottom of the plot&#39;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>The style of the different labels can be set with <code>theme()</code>:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="plotting-the-data.html#cb188-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Condition&#39;</span>,</span>
<span id="cb188-2"><a href="plotting-the-data.html#cb188-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&#39;Area [µm]&#39;</span>,</span>
<span id="cb188-3"><a href="plotting-the-data.html#cb188-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">title=</span><span class="st">&#39;This is the title...&#39;</span>,</span>
<span id="cb188-4"><a href="plotting-the-data.html#cb188-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle=</span><span class="st">&#39;...and this is the subtitle&#39;</span>,</span>
<span id="cb188-5"><a href="plotting-the-data.html#cb188-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&#39;A caption is text at the bottom of the plot&#39;</span>) <span class="sc">+</span></span>
<span id="cb188-6"><a href="plotting-the-data.html#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>),</span>
<span id="cb188-7"><a href="plotting-the-data.html#cb188-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>),</span>
<span id="cb188-8"><a href="plotting-the-data.html#cb188-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&#39;orange&#39;</span>),</span>
<span id="cb188-9"><a href="plotting-the-data.html#cb188-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">color=</span><span class="st">&#39;slateblue&#39;</span>),</span>
<span id="cb188-10"><a href="plotting-the-data.html#cb188-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">color=</span><span class="st">&#39;slateblue&#39;</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb188-11"><a href="plotting-the-data.html#cb188-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">&#39;grey60&#39;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>)</span>
<span id="cb188-12"><a href="plotting-the-data.html#cb188-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<p>This is a demonstration of how the different pieces of text can be modified, not a template for a proper data visualization since it uses too many, unnecessary, colors!</p>
</div>
</div>
<div id="plot-a-lot---continuous-data" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Plot-a-lot - continuous data<a href="plotting-the-data.html#plot-a-lot---continuous-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It can be a challenge to look at individual data or samples instead of summaries when you have a large amount of data. I will illustrate a number of options based on the timeseries data of Rac activity, that we have seen before. This dataset is still quite simple, but given its heterogeneity it illustrates well how the data can be presented in such a way that all traces can be inspected.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="plotting-the-data.html#cb189-1" aria-hidden="true" tabindex="-1"></a>df_Rac <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;df_S1P_combined_tidy.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">&#39;Rac&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(activity))</span>
<span id="cb189-2"><a href="plotting-the-data.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_Rac)</span></code></pre></div>
<pre><code>  Condition Treatment Time  object  activity
1       Rac       S1P    0 Cell 01 1.0012160
2       Rac       S1P    0 Cell 02 1.0026460
3       Rac       S1P    0 Cell 03 1.0022090
4       Rac       S1P    0 Cell 04 0.9917870
5       Rac       S1P    0 Cell 05 0.9935569
6       Rac       S1P    0 Cell 06 0.9961453</code></pre>
<p>We have seen this data before, but let’s look at this again in an ordinary line plot:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="plotting-the-data.html#cb191-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rac, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>object))</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p>There is a lot to see here and it is a bit of mess. Clearly, there is variation, but it is difficult to connect a line, by its color to the cell it represents. Below, there are some suggestions how this data can be presented more clearly.</p>
<div id="small-multiples" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Small multiples<a href="plotting-the-data.html#small-multiples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Small multiples remind me of a stamp collection, where every stamp is a (small) plot. This works very well to display lots of data. It is also pretty straightforward in ggplot2 with <code>facet_wrap()</code>:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="plotting-the-data.html#cb192-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rac, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span></span>
<span id="cb192-2"><a href="plotting-the-data.html#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb192-3"><a href="plotting-the-data.html#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>object)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<p>I got rid of color, since it would be redundant and the improved contrast of the black line helps to focus on the data.</p>
<p>The lay-out of the 32 mini plots can be improved by fixing the number of columns:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="plotting-the-data.html#cb193-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rac, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span></span>
<span id="cb193-2"><a href="plotting-the-data.html#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb193-3"><a href="plotting-the-data.html#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>object, <span class="at">ncol =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>Since the small multiple is at its best, when the data stands out and the text and other elements are minimized. Here is an extreme version of the plot to make that point:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="plotting-the-data.html#cb194-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rac, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span></span>
<span id="cb194-2"><a href="plotting-the-data.html#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-3"><a href="plotting-the-data.html#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>object, <span class="at">ncol =</span> <span class="dv">8</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<p>Further optimization of a small multiple plot is discussed in <a href="complete-protocols.html#protocol-3">Protocol 3</a>. For complex experimental designs, the data can split according to two different factors. This also uses a faceting strategy, with the <code>facet_grid()</code> function. This works well when the data has two discrete variables and the application of this function is demonstrated in <a href="complete-protocols.html#protocol-4">Protocol 4</a>.</p>
</div>
<div id="heatmaps" class="section level3 hasAnchor" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Heatmaps<a href="plotting-the-data.html#heatmaps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Heatmaps are well suited for dense data and have traditionally been used for microarray and other -omics data. Heatmaps can also be used for timeseries data. To do this, we (i) keep the x-axis as is, (ii) map the objects on the y-axis and (iii) specify that the color of the tile reflects activity:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="plotting-the-data.html#cb195-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rac, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>object)) <span class="sc">+</span></span>
<span id="cb195-2"><a href="plotting-the-data.html#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>activity))</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
<p>The default colorscale is not ideal. I personally like the (colorblind friendly) viridis scale and this colorscale can be used to fill the tile with <code>scale_fill_viridis_c()</code>.</p>
<p>To sort the data according to the object labels as they appear in the dataframe:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="plotting-the-data.html#cb196-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rac, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>object)) <span class="sc">+</span></span>
<span id="cb196-2"><a href="plotting-the-data.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>activity)) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>To reverse the order of the objects we can use <code>fct_rev()</code>:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="plotting-the-data.html#cb197-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rac, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span><span class="fu">fct_rev</span>(object))) <span class="sc">+</span></span>
<span id="cb197-2"><a href="plotting-the-data.html#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>activity)) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>()</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
<p>A heatmap does not need a grid and usually has no axes. Plus, when there are many objects, it makes sense to hide their names, ticks and the y-axis label:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="plotting-the-data.html#cb198-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span>   <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rac, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span><span class="fu">fct_rev</span>(object))) <span class="sc">+</span></span>
<span id="cb198-2"><a href="plotting-the-data.html#cb198-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>activity)) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb198-3"><a href="plotting-the-data.html#cb198-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb198-4"><a href="plotting-the-data.html#cb198-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove borders</span></span>
<span id="cb198-5"><a href="plotting-the-data.html#cb198-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-6"><a href="plotting-the-data.html#cb198-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove grid</span></span>
<span id="cb198-7"><a href="plotting-the-data.html#cb198-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-8"><a href="plotting-the-data.html#cb198-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-9"><a href="plotting-the-data.html#cb198-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove text of the y-axis</span></span>
<span id="cb198-10"><a href="plotting-the-data.html#cb198-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-11"><a href="plotting-the-data.html#cb198-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove ticks on y-axis</span></span>
<span id="cb198-12"><a href="plotting-the-data.html#cb198-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-13"><a href="plotting-the-data.html#cb198-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove label of y-axis</span></span>
<span id="cb198-14"><a href="plotting-the-data.html#cb198-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-15"><a href="plotting-the-data.html#cb198-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make x-axis ticks more pronounced</span></span>
<span id="cb198-16"><a href="plotting-the-data.html#cb198-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb198-17"><a href="plotting-the-data.html#cb198-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb198-18"><a href="plotting-the-data.html#cb198-18" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
</div>
<div id="custom-objects" class="section level3 hasAnchor" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> Custom objects<a href="plotting-the-data.html#custom-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The use of titles, captions and legends will add infomration to the data visualization. Tweaking the theme will improve the style of the plot and give it the right layout. There’s another layer of attributes that are not discussed yet and these are custom objects and labels. These additions will help to tell the story, i.e. by explaining the experimental design.</p>
<p>Let’s look at the cellular response to stimulation with a ligand. The df_Rho dataframe that we have used earlier is used in this example and we plot the average and standard deviation:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="plotting-the-data.html#cb199-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span>   <span class="fu">ggplot</span>(<span class="at">data=</span>df_Rho, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>activity)) <span class="sc">+</span> </span>
<span id="cb199-2"><a href="plotting-the-data.html#cb199-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom=</span><span class="st">&#39;line&#39;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb199-3"><a href="plotting-the-data.html#cb199-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_summary</span>(<span class="at">fun.min=</span><span class="cf">function</span>(y) {<span class="fu">mean</span>(y) <span class="sc">-</span> <span class="fu">sd</span>(y)},</span>
<span id="cb199-4"><a href="plotting-the-data.html#cb199-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fun.max=</span><span class="cf">function</span>(y) {<span class="fu">mean</span>(y) <span class="sc">+</span> <span class="fu">sd</span>(y)},</span>
<span id="cb199-5"><a href="plotting-the-data.html#cb199-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">geom=</span><span class="st">&#39;ribbon&#39;</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>, <span class="at">size =</span>.<span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb199-6"><a href="plotting-the-data.html#cb199-6" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
<p>The ligand is added at t=1.75 and we can add a vertical line with <code>geom_vline()</code> to indicate this:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="plotting-the-data.html#cb200-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.75</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;grey20&quot;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<p>More flexible labeling is provided with the <code>annotate()</code> function, which enables the addition of line segments, rectangles and text. First, let’s reproduce the the previous plot with this function, by defining a line segment. The line segment has two coordinates for the start and two for the end. The x position is 1.75 for both start and end. For the y-coordinate we can use <code>Inf</code> and <code>-Inf</code> to define the endpoints of the line. The use of <code>Inf</code> has two advantages. We do not need to define the exact points for the start and end and we prevent rescaling of the plot to show the segment:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="plotting-the-data.html#cb201-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="fl">1.75</span>, <span class="at">xend =</span> <span class="fl">1.75</span>, <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">yend =</span> <span class="cn">Inf</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;grey20&quot;</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<p>In a similar way we can define a rectangle to highlight the time where the ligand was present (It is possible to use <code>Inf</code> for xmax here, in that case the blue rectangle would fill up the entire plot to the right). Since the rectangle is added as the last layer, it would occlude the data. That’s why a an alpha level of 0.1 is used to make the rectangle transparent:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="plotting-the-data.html#cb202-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="fl">1.75</span>, <span class="at">xmax =</span> <span class="dv">10</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<p>We can also add an rectangle to the top of the graph:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="plotting-the-data.html#cb203-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="fl">1.75</span>, <span class="at">xmax =</span> <span class="dv">10</span>, <span class="at">ymin =</span> <span class="fl">1.26</span>, <span class="at">ymax =</span> <span class="fl">1.27</span>, <span class="at">fill=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb203-2"><a href="plotting-the-data.html#cb203-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">5</span>, <span class="at">y=</span><span class="fl">1.29</span>, <span class="at">label=</span><span class="st">&quot;ligand&quot;</span>, <span class="at">size=</span><span class="dv">6</span>)</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
<p>In the example above, the rectangle and text are added to the plot area and the y-axis is expanded. To move the annotation out of the plot area, we need to increase the white space above the plot with <code>theme()</code> and we can scale the plot with <code>coord_cartesian()</code>:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="plotting-the-data.html#cb204-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="fl">1.75</span>, <span class="at">xmax =</span> <span class="dv">10</span>, <span class="at">ymin =</span> <span class="fl">1.25</span>, <span class="at">ymax =</span> <span class="fl">1.26</span>, <span class="at">fill=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb204-2"><a href="plotting-the-data.html#cb204-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">5</span>, <span class="at">y=</span><span class="fl">1.28</span>, <span class="at">label=</span><span class="st">&quot;ligand&quot;</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb204-3"><a href="plotting-the-data.html#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.98</span>,<span class="fl">1.23</span>), <span class="at">clip =</span> <span class="st">&#39;off&#39;</span>) <span class="sc">+</span></span>
<span id="cb204-4"><a href="plotting-the-data.html#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">50</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">&quot;pt&quot;</span>))</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<p>The annotation is part of the plot and would normally be invisible since everything outside the plot area is clipped. To show the annotation, <code>clip = 'off'</code> is needed in the code above. However, this may lead to undesired behavior when the scaling is set in such a way that the data falls outside the plot area. Although you could use it to create a dramatic ‘off-the-charts’ effect.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="plotting-the-data.html#cb205-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="fl">1.75</span>, <span class="at">xmax =</span> <span class="dv">10</span>, <span class="at">ymin =</span> <span class="fl">1.25</span>, <span class="at">ymax =</span> <span class="fl">1.26</span>, <span class="at">fill=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb205-2"><a href="plotting-the-data.html#cb205-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">5</span>, <span class="at">y=</span><span class="fl">1.28</span>, <span class="at">label=</span><span class="st">&quot;ligand&quot;</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb205-3"><a href="plotting-the-data.html#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.98</span>,<span class="fl">1.15</span>), <span class="at">clip =</span> <span class="st">&#39;off&#39;</span>) <span class="sc">+</span></span>
<span id="cb205-4"><a href="plotting-the-data.html#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">130</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">&quot;pt&quot;</span>))</span></code></pre></div>
<p><img src="DataViz-protocols_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<p>This concludes a couple examples of the <code>annotate()</code> function. Protocol 5 is a good example how these annotations can assist to build an informative data visualization.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="read-and-reshape.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="complete-protocols.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
